Perfecto, pues pongo la clase a grabar. Sí, profe, buenas tardes. Y empezamos. Bienvenidos a la sexta sesión de Fundamentos Tecnológicos para el Tratamiento de Datos. Y bueno, la sesión de hoy, pues obviamente vamos a continuar con SQL, ¿de acuerdo? Y hoy va a ser una de las clases un poco más duras, por así decirlo, porque aquí es donde por fin le vamos a dar el uso a estas claves que llegamos viendo desde la primera sesión, ¿vale? Porque hoy básicamente vamos a aprender a combinar tablas, ¿vale? Y para ello, como ya hemos visto cuando hacíamos los pequeños ejercicios de Excel, ¿no? De que realmente son las claves las que nos permiten combinar la información, ¿vale? Antes de eso vamos a hacer un breve repaso de lo que vimos la semana pasada, que es básicamente el SELECT, el FROM y el WHERE, que son las cláusulas básicas que empieza toda consulta, ¿vale? Recordemos que en el select nosotros especificamos los atributos, otras palabras, las columnas, ¿vale? En el from especificamos la tabla de la cual queremos nuestra información. Y en el where lo que estamos haciendo es filtrar a nivel de fila, ¿de acuerdo? Como la semana pasada vimos, por ejemplo, el año. Aquí, esta consulta que nos la hicimos la semana pasada, tenemos select from web, select con esto de aquí que ahora explicaré qué es, que es el ID asignatura, nombre y especialidad de la tabla asignatura, donde el curso, me dice que a nivel de fila es 3 y el número de créditos es superior a 4,5. ¿de acuerdo? también vimos el distinct vimos el order by vimos el between mayor o igual, menor o igual in o not in para un conjunto de valores el like y el not like aparte de los nulos bien, por lo tanto hoy lo que vamos a hacer es combinar las tablas y la mejor manera de verlo es pues mediante la práctica ¿de acuerdo? si recordáis La semana pasada, nosotros trabajamos con una tabla que se llama asignatura, ¿verdad? Y volviendo a lo que veníamos practicando el primer día, nosotros sabemos que toda tabla debe tener una clave primaria, ¿verdad? En este caso, ¿cuál es la clave primaria de esta tabla? El ID de asignatura. Eso es, es el ID de asignatura. Después veíamos que las tablas pueden tener claves ajenas o no tenerlas. En este caso, ¿podéis identificar a simple vista si hay alguna clave ajena? ¿Qué pensáis? Sí, profe, el prof ID. Prof ID. Efectivamente. Y sin que yo lo explique, ¿a qué creéis que hace referencia ese prof ID? El profesor que edita la clase Efectivamente Es decir, si yo ahora me voy a profesor ¿Vale? Voy a ejecutar ambos, vemos que, por ejemplo ¿Cómo se llama el profesor de estrategia de gestión empresarial basada en datos? Javier Es el profesor 245 ¿Qué es quién? Javier Bien, entonces a nosotros al tener la clave ¿Qué podemos hacer? Combinar ambas tablas. Para ello, ¿vale? Para la combinación de tablas, vamos a ver tres funciones, ¿vale? Hay otras, pero vamos a ver tres, que son inner join, left join y right join, ¿vale? Bien, vamos a empezar con el primero que es el INER, que es el básico que siempre se aplica. Para combinar dos tablas, nosotros siempre tenemos que empezar con un SELECT y un FROM, es decir, una consulta normal. Y a continuación, tenemos que especificar la cláusula de combinación, que en este caso, INERJOIN. Y acto seguido, la segunda tabla, que es profesor. ¿Vale? Y después especificamos on para indicar en qué claves nos vamos a basar para combinar la tabla, que en este caso hemos dicho que es profesor ID, ¿verdad? Entonces yo le digo que profesor ID sea igual a profesor ID. ¿Vale? ¿Qué ocurre? Si yo ejecuto esto, la consulta en sí está bien Pero le falta información a SQL ¿Por qué? Fijaros el error que nos arroja Nos dice que el profesor ID es Ambiguo ¿Por qué? Porque no es específico De qué tabla Eso es, porque en ambas tablas Hay un profesor ID Entonces, en la combinación Yo tengo que decirle cuál es cuál. Para ello, yo, o sea, normalmente lo que se hace es especificar la tabla, punto y el campo, ¿vale? Es decir, este profesor id viene de la tabla asignatura y este profesor id viene de la tabla de profesor, ¿vale? Y ahora sí, si yo ejecuto, fijaros, se han combinado ambas tablas, ¿vale? Hasta aquí sería la tabla de asignatura y de aquí a aquí la de profesor. Pero no simplemente se han unido tal cual, como por arte de magia, sino que lo han hecho a través de qué? A través de las claves de profesor y de... ¿sí? igualmente aquí el nombre de las tablas bastante sencillo, es corto en la vida real os vais a encontrar tablas que tienen unos nombres enormes ¿vale? que suele pasar, de hecho es lo más normal entonces, si tiene un nombre muy muy muy largo, pues a la hora de escribir código, no es lo ideal Para ello, nosotros nos vamos a basar en algo denominado alias, ¿vale? Una especie como de máscara que le vamos a poner a las tablas. Y se hace de la siguiente manera. Justo después del nombre de la tabla, especifico as y le doy ese alias o sobrenombre. Por ejemplo, en este caso, para asignatura le voy a poner a porque empieza por la letra a. Y de profesor le voy a especificar p porque empieza por la letra p, ¿vale? Los alias son libres, podéis utilizar el que vosotros queráis. Entonces, ahora, en vez de utilizar aquí asignatura y profesor, simplemente puedo especificar A y P. ¿Vale? Y funcionaría exactamente igual. Ahora bien, los alias no sirven solo para la parte del join y del from, sino que también para el sell. fijaros, si yo especifico a punto asterisco, ¿qué le estoy diciendo a SQL? Estoy diciendo que me devuelva ¿Dónde está el campo de la tabla? Efectivamente, si ahora ejecuto esto, solo me devuelven los campos de la tabla y si ahora, por ejemplo, pongo esto p.asterisco me va a devolver los de la tabla A y de la tabla P ¿Eso es todo? Esto sería el equivalente a simplemente establece el asterisco que devolvería lo mismo pero lo más normal es que por ejemplo de la tabla de profesor imaginar que sólo nos piden el nombre por lo tanto especificó a asterisco coma p y el nombre de el profesor vale por lo tanto la secuencia de combinación es selector en En el front viene la primera tabla, le especifico un alias, inner join, la segunda tabla, le asigno otro alias, después especifico on y especifico las claves de combinación. ¿Sí? Y ahora os pregunto, que es una pregunta bastante común, ¿qué ocurre si yo cambio el orden de las claves? ¿Alterará algo? ¿Qué pensáis? No, porque cada una tiene su base. Efectivamente, es decir, en las claves si las pongo al revés da igual, porque la combinación se hará exactamente igual. bien hemos visto inner join inner join básicamente que cuando combina las tablas solo nos devuelve los resultados que tengan una un match o un equivalente entre las dos tablas ¿vale? es decir que la clave tiene que estar presente en ambas tablas y entonces me la devuelve, es decir, si hay alguna clave que no está presente en la otra tabla no me la va a mostrar ¿vale? porque inner join es una unión perfecta entre las dos tablas si hay algún registro entre las dos tablas que no tiene su equivalente en la otra, no aparece ¿significa que por ejemplo si es, profesor, perdón ¿significa que si es que no encuentre coincidencia me pondrá nul en la tabla en el resultado? No, ni te lo mostrará siquiera ¿Vale? Pero por ejemplo yo tengo en el ID, en el PROVIDE de asignatura yo tengo por decir 999 pero voy a la de profesor y el 999 que me va a salir en la columna de... No te va a aparecer, te la va a desechar ese registro, te lo desecha ¿Vale? De hecho, Verónica, esa es a lo que iba. Fijaros, si yo ejecuto las dos tablas por separado, bueno, si yo combino ambas, tengo siete registros, ¿verdad? Si yo las ejecuto por separado, fijaros, la tabla de asignatura, ¿cuántos registros tiene? ¿Siete o más? 9 por ejemplo, el ejemplo que tú decías Verónica, imagínate que hay un profesor E que no cuadra en este caso, ¿hay alguno que no cuadra? pues parece que sí, ¿no? ¿que son cuáles? los nulos ¿verdad? es decir, en la tabla de profesor aquí no hay ningún nulo, ergo no se combinan entonces, ¿qué pasa? práctica geisterna, trabajo a fin de máster si yo utilizo innerjoin no aparecen ¿por qué? porque innerjoin tiene que haber una equivalencia ¿vale? ahora bien, como dice la compañera ¿y qué pasa si yo necesito que me aparezcan esos nulos? ¿verdad? es decir, yo quiero que me aparezcan esos valores nulos prácticas externas y trabajo fin de master entonces, ¿qué es lo que tengo que hacer? Pues obviamente INEXJOIN no lo puedo utilizar y tengo que utilizar LEFTJOIN. ¿Vale? El LEFTJOIN como su nombre indica izquierda, ¿vale? Lo que está haciendo es darle prioridad a la tabla de la izquierda que en este caso es la primera tabla que es la tabla de asignatura. ¿Vale? En otras palabras, le estoy diciendo devuélveme todos los registros de asignatura vale tengan o no su equivalente en profesor por lo tanto si yo ejecuto esta consulta cuántos registros me van a aparecer 7 o 9 9 Efectivamente, fijaros con el LiveJoy prácticas externas y trabajo PIN de máster sí que me aparece No tienen profesor por lo tanto, en el nombre del profesor ¿qué valores tengo? Nulos ¿Por qué? Porque no hay un equivalente del profesor y al no verlo no hay dato, se asigna valor nulo ¿Sí? ¿En ese sentido cómo le cambiamos la prioridad a la tabla o cómo sabemos que la prioridad es asignatura solo porque está en from? Porque es left Fijaros, esto realmente es la parte de la combinación, por así decirlo Si yo le digo, si especificamos left join estoy diciendo que la tabla que está a la izquierda, en este caso asignatura devuélveme todos los registros ¿Vale? Por eso lo que iba a hacer a continuación es esto está también el ride joy que es la contrapartida del led si en el led le daba prioridad a la primera tabla en el ride derecha a qué tabla le estoy dando prioridad a la de profesores eso es y sabiendo eso cuántos registros voy a obtener siete o nueve porque porque efectivamente sólo hay siete profesores entonces me devuelve todos los profesores y si tiene una equivalencia en asignatura bien y si no la tuviese en este acaso la tiene, ¿qué pasaría? Pues que habría aquí, para asignatura, valores nulos. ¿Vale? Leemos mucho más ejemplos, no os preocupéis. Dudas que tengáis, que veo que hay un par de personas con el micro abierto. Disculpa, hay una pregunta de lenguaje. Sí, dime. En from y en left estamos asignando el nombre de la tabla a la variable a y p, ¿verdad? Correcto. Es decir, el alias, en vez de utilizar asignatura aquí o aquí, utilizo la a, que es una máscara, ¿para qué? Para asignatura. Correcto. En el orden del lenguaje no crea ningún conflicto que se utilicen las variables antes como en el select, porque hay otros lenguajes que, por ejemplo, para mí ahí en select estás llamando las variables previo a la asignación. Sí, sí, lo entiendo. Es decir, lo que es un lenguaje de programación normal, todo al fin y al cabo va escalado. ¿Aquí qué ocurre? Cuando se ejecuta SQL, SQL te lo ejecuta todo. Es decir, select, from, where, todo a la vez. ¿Vale? Por detrás, lo que hace es que siempre va a empezar por el from, realmente. ¿Por qué? Porque tiene que primero identificar la tabla de la que tiene que obtener información por lo tanto lo primero que siempre llega es el front y después los demás vale que tiene razón jorge o sea realmente el lenguaje programación normales porque esto realmente es programación pero no se comporta como por ejemplo el re pay un ejemplo en ese lenguaje si todo va escalado de arriba hacia abajo pero si con funciona un poco diferente gracias sin problema alejandro a que te refieres con en máscaras posterior y es decir lo que acaba de preguntar jorge que primero es decir que se le asigna el alias aquí en vez de hacerlo antes del select es lo que te referías es lo que acaba de preguntar o como se ve bien me refiero a qué por ejemplo, cuando has hecho el select.a select. select. Luego todos, ¿no? Con el asterisco. Como hasta que yo en el from no le ponga... O sea... Claro, vale. Tú empiezas diciendo, yo ya sé que voy a enmascarar y entonces digo select.a y luego ya pues pues ya sigo con el A, ¿sabes? Te sigo, pero fijaros, cuando yo he empezado a combinar, ¿qué es lo primero que he hecho? He puesto select, pero en el select para continuar, ¿qué es lo que he hecho? ¿Lo habéis fijado? Como no estoy ejecutando, yo siempre que pese igual, pongo select asterisco, después voy al front, de lo que necesite, y lo último que cambio es el select. Realmente, ¿qué ocurre? Yo no lo estoy ejecutando todo a la vez, es decir, no primero el select, después el formato, sino se ejecuta todo en el mismo instante ¿vale? por lo tanto, yo siempre siempre, siempre, de hecho lo hago en el trabajo siempre que empiezo una consulta nueva pongo select asterisco, después me voy a combinar las tablas y ya lo último que hago ¿vale? o no, depende un poco el desarrollo que uno esté haciendo, ¿no? pero lo primero que siempre pongo select asterisco después de ir viendo las tablas que voy a combinar y, por ejemplo si no estoy seguro, ¿vale? pues simplemente hago, pues A punto la clave, P punto la clave, o similar. Pero es lo que preguntaba también Jorge, es decir, tener en cuenta que esto no va como secuencial. Es decir, antes de ejecutar algo, sobre todo en la vida real, tú puedes ir ejecutando parte por parte de lo que vaya modificando en la query, etc. Pero que en el fondo no es que vaya escalado del sec, al from, al where, etc. Todo empieza en el from. ¿vale? y ya después van las otras partes ¿ok? con el tema de los alias digo, para que no os confunda, simplemente ponéis asterisco en principio, hacéis todo lo que tenéis que hacer y ya el select lo hacéis al final de hecho cuando corrijamos ejercicio voluntario veréis que siempre empiezo así primero, identifico las tablas hago los filtros en el web y ya por lo último lo que suele ir es el select, ¿vale? parece un poco contraintuitivo lo que sería un lenguaje de programación normal, pero que en el fondo es cómo funciona SQL, ¿no? Entonces, yo por lo menos, cada uno puede escribirlo como quiera, por lo menos es la manera en la que suelo un poco escribirlo. ¿Vale? Profe, entonces vos ejecutas una vez que terminas de poner el SELECT. Efectivamente, es decir, una vez que, es decir, para ejecutar tengo que tener un SELECT FROM obligatorio, ¿vale? Es decir, si en el select from no puedo ejecutar nada. Por lo tanto, si no tengo claro qué es lo que tengo en el select, pues simplemente pongo asterisco. Ahora bien, ahora que estamos aprendiendo, a lo mejor en la vida real no es una buena idea. Si vais a utilizar dos tablas que tienen millones de registros, pues lo mismo no es lo ideal. La primera ejecución, hacerlo con dos tablas de millones de registros combinándolas con un asterisco, ¿vale? Lo mismo, simplemente utilizando un campo de una y de otra, ¿vale? Para que haces una idea. Perfecto. Gracias. ¿Ok? ¿Alguien más? Sí El alias solamente Es para facilitar La escritura Sí, realmente sí, es para facilitar Tanto la escritura Como para el propio SQL Saber dónde tiene que buscar Es decir El alias, si yo lo pongo aquí Yo, imagínate que en el select Tengo aquí, en vez de tener Pues dos o tres campos tengo 10 o 20, ¿no? Y va a pasar a lo mejor que de dos tablas tengan el mismo nombre, cosa que ahora también veremos, ¿no? Entonces, claro, si yo tengo el alias justo delante del atributo y veo, por ejemplo, que SA, automáticamente sé de dónde viene, ¿vale? O si lo pongo en el web, porque en el web también se utilizaría, ¿vale? Entonces, de cara a leer, para nosotros, las personas, es lo más sencillo. ¿Qué ocurre? Que también podemos optar de no utilizarlo y poner lo que he hecho antes, el nombre de la tabla. ¿Vale? SQL es igual que tú utilices el nombre de la tabla que utilices un alias. Pero para nosotros es mucho más sencillo, pues obviamente, identificarlo todo con un alias. ¿Vale? Profesor, otra pregunta. Ya con respecto, por ejemplo, si quiero traer más de una columna aparte de nombre en profesor, ¿Cómo se pondría? Por ejemplo, nacionalidad ¿Tendría nombre como nacionalidad? ¿O cómo sería? Esto lo hemos visto, pero ¿tú cómo piensas? Claro, dímelo, deletreame cómo tú crees que es y lo probamos a ver si es verdad, porque esto técnicamente lo hemos visto para ver si es intuitivo si se lo está quedando. ¿Qué es lo que haría? Por ejemplo, ¿qué haría una nacionalidad aquí? ¿Qué harías? Basándote en lo que tenemos escrito, te puedo dar una idea de cómo sacarlo, ¿verdad? Sí, sería P nombre, coma, P nacionalidad, punto nacionalidad. Correcto. P punto nacionalidad. Ok. Listo. Es decir, recordad que nosotros podemos incluir todos los atributos que queramos, separado por comas, en este caso con combinación con la... con la lealidad correcta y el nombre correcto del atributo. ¿Ok? un poco para maquinar con la cabeza imagina que yo aquí para eso la misma cuáles pero cambió el orden de las tablas en el iner joy cambiará algo si yo cambio el orden de las tablas o dará exactamente el mismo resultado Esa es la segunda tabla La tabla de profesor en este caso Claro, primero iría la tabla de profesor Y después la tabla de asignatura En el select, ya os digo yo que no va a cambiar nada Porque el orden es el que es Yo lo que digo en el tema de combinar Haciendo in-ex-joint ¿Varía algo? ¿Sí o no? No, no pasa nada Efectivamente No pasa absolutamente nada Porque el in-ex-joint, lo que hemos dicho como al fin y al cabo tiene que ser una equivalencia entre ambas tablas en el joint da igual porque tabla empecemos y en el left qué pensáis variará el resultado si uno y si variaría en este caso cuántos registros vamos a obtener siete o nueve 7. Muy bien, ¿por qué? ¿A qué tabla le estamos dando prioridad? A la de la izquierda, que es la de profesor. Hay total de 7 profesores, ¿vale? Fijaros, profesor y left-join asignatura es el equivalente a asignatura right-join profesor. ¿Todo el mundo lo ve? es decir, esto y esto es lo mismo entonces aquí el último ejemplo si yo cambio el orden profesor, write join asignatura ¿cuántos atributos perdón, cuántos registros voy a obtener? nueve efectivamente muy bien, ¿por qué? le doy prioridad a asignaturas que tiene el profesor, es decir, todos los registros de la asignatura y si tiene su equivalencia en profesor. Es decir, esto sería el equivalente a esto. ¿Vale? ¿Por qué quiero decir esto también? Un poco para rompernos la cabeza, pero también que no sé si lo he mencionado ya, pero suelo mencionar mucho, de que hay varias formas, como en todo lenguaje de programación, de llegar al mismo punto. El camino no es único. Esto, por ejemplo, es un ejemplo. Dependiendo de qué tabla pactamos, podemos llegar al mismo destino. ¿Vale? Prof, una pregunta. Digamos, si yo quisiera ver más que todo la información del profesor y adicionarla a eso, quisiera ver solo la materia, el nombre de la materia que ya tengo que modificar es el select, ¿cierto? Que es lo que trabajamos. Claro. ¿Cómo lo harías? Es decir, si solo quieres el nombre del profesor y el nombre de la asignatura, ¿qué harías? Aquí, ¿qué cambiarías aquí en esta consulta? Pondría a punto nombre. Muy bien, eso es. Y de hecho, ya que estamos aquí, voy a aprovechar. Imaginad que vosotros tenéis este resultado, lo guardáis en Excel y lo mandáis a quien os lo haya pedido. ¿Veis alguna pega aquí? que ambos campos ¿qué? ambos campos se llaman igual ¿no? en este caso es bastante evidente de que nosotros sabemos que esto es asignatura y esto es profesor, pero una persona que a lo mejor no lo tiene tan claro que, entonces aquí ya aprovecho para deciros, los alias no sirven solo para las tablas dentro del from y de los yo, sino también lo podemos utilizar en los atributos ¿vale? puedo poner nombre asignatura y nombre profesor vale y ejecutó que ocurre yo no estoy modificando nada dentro de las tablas ojo no estoy cambiando nada simplemente le estoy poniendo esa máscara en el resultado que estoy obteniendo vale es decir no estoy modificando nada dentro de la base de datos ni mucho menos pero al ejecutar la enmascaró con otro nombre ok es muy útil la verdad ya habréis bueno la utilidad más básica nombre y nombre pero puede pasar no de que al final cabo dos campos se llaman igual sea muy parecido solo que uno sea el nombre del producto y el otro es nombre de categoría del producto entonces claro cuál sabes tú cuál es cuál vale y esto es algo muy típico de hecho en la base de datos siempre que haya una descripción nombre de cliente nombre del producto nombre proveedor pondrá depende la base de datos podría descripción descripción de registro y hasta entonces tú vas a tener al final muchos muchos columnas que son descripción pero no hace referencia al que sea en el código se puede ver, pero ya después si lo descargamos en Excel, ya no queda tan claro. Disculpa, una pregunta de organización. En SQL se puede dejar guardado, si es una base con muchas tablas, todas las variables que hemos utilizado, se puede como consultar o es como... ¿Qué variables? ¿Esto te refieres, Jorge? Sí, por ejemplo, haz de cuenta que tenemos como mil tablas y les empezamos a cambiar y asignar a una variable. Pero no le estamos asignando ninguna variable. Es decir, esto no se está guardando en ningún lado. Esto solo es válido en el proceso de la ejecución, de cuando ejecutamos la consulta. Es decir, esto no se almacena. Al igual que la consulta, igual que la consulta tampoco se almacena a menos que nosotros guardemos el script. ¡Oh! Más adelante veremos, bastante más adelante, cómo nosotros, si creamos una consulta compleja que vamos a reutilizar cómo guardarla en la base de datos pero se llama vista o view pero es lo veremos mucho más adelante vale de estos alias estas variables no se guardan estas variables son válidas sólo en el momento de ejecución ok más dudas vamos a si no bueno preguntarme las dudas pero mientras tanto vamos a ver otro ejemplo de combinación vale una consulta el punto y coma que acabas de poner qué significa el que perdón el punto y coma el diseño en sí cual serve es realmente no suele valer para mucho pero esto por ejemplo ejemplo en el snowflake que lo que yo trabajo me permite como separar los baches de ejecución vale decir se para un poco las consultas yo básicamente he puesto aquí para saber que es distinto vale es decir quien sube al server no se utiliza también pega en maya sql fijaros si yo pongo esto que da la semana pasada vale pongo el punto y coma si yo ejecuto esto creo que era así, ¿no? o aquí vale, ¿veis? me ejecuta solo lo que hay después de esto, o si lo pongo aquí me ejecuta solo esto, ¿vale? es realmente una tontería un poco para diferenciar los diferentes cachitos de código, porque tened en cuenta que nosotros técnicamente podemos utilizar o ejecutar una consulta a la vez ¿vale? entonces a lo mejor que si queremos dividirla por partes o una mimoja tener varias consultas que no tengan nada que ver, se suelen separar. En SQL Server no vale para nada porque al final te lo vomita todo. Pero, por ejemplo, en MySQL o en otras herramientas sí. Entonces, esto es una manía que tengo de la herramienta con la que trabajo en el día a día. Vale, gracias. Bien. Como decía, vamos a practicar más. Tenemos dos tablas más que es alumno y computador. ¿Vale? Fijaros, ambas tienen cinco registros y mi primera pregunta es, ¿yo puedo combinar estas tablas? ¿Hay alguna clave? Sí. Es decir, lo veis todos, ¿no? Esto parece que es la misma clave, pero ¿qué ocurre? tiene diferente nombre, en cada tabla parece que tiene diferente nombre, esto también puede ser lo normal, es decir, podéis encontrar en la vida real que el nombre de la clave no coincida, pero realmente sea la clave que hay que utilizar para combinar, entonces acostumbraros también a eso, bien, por lo tanto vamos a combinar, siempre digo lo mismo, select, por ejemplo, ponemos estrella ahora, from alumno le damos un alias, vamos a ponerle por ejemplo, al el join que vayamos a utilizar, ponemos iner join en este caso, la segunda tabla y le damos el alias ¿vale? seguido de on y ahora combino, entonces al ordenador igual a co computado. ¿Vale? Ejecuto, anda, pero no me funciona. ¿Por qué? Que hagan al contrario los nombres. Efectivamente, muy bien. Esto suele también ser un error bastante común. Es decir, computador está en alumno y ordenador está en computador. ¿Vale? Y ejecuto. Y fijaros, me aparecen cinco registros, ¿no? Y nosotros sabíamos que en alumno y en computador teníamos también 5 registros entonces ¿qué pasa? si lo hemos combinado en principio ¿qué? es un 1 a 1 ¿no? está todo bien y ahora os pregunto ¿está bien el match? sí, porque había uno que no estaba en la tabla inicial que era como el ordenador 008 Muy bien, fijaros, aunque el número de registros coincida, no quiere decir que sea un 1 a 1. Por ejemplo, como ha dicho la compañera, el 8 no está aquí. ¿Hay algún otro que no está? Aparte del 8. El 040. El 40 tampoco está. Pero hay 5 registros. ¿Por qué? Porque están repetidos. 9 y 10. el 9 y el 10 están repetidos, efectivamente. Por lo tanto, no os fieis que al combinar, porque en el mismo registro eso quiere decir que todo está bien, porque, seamos sinceros, no vamos a vivir en un mundo de uno a uno, ¿vale? Normalmente va a ser uno a uno. Bien, entonces, si yo hago un inner join, me sale esto. ¿Pero qué ocurre? Ahora ya me entra la duda y digo, guay, ¿qué pasa si a lo mejor hay más alumnos que ordenadores o viceversa? Entonces, ahora que estamos aprendiendo, siempre que vayamos a combinar algo, os pediré que apliquéis los tres JOIN y veáis cuál es el que mejor se ajusta a la pregunta que os estoy haciendo. Por lo tanto, voy a probar con left join. Y fijaros, con left join me devuelve también 5 registros y mirando por encima parece igual. ¿Vale? Pero, ¿qué pasará con el right join? efectivamente como hemos visto hay dos ordenadores que no tienen su equivalente en alumno ¿sí? es decir, ante la duda que estamos en clase con la parte de la práctica, probad los tres ¿por qué? porque yo os pediré, a partir de la semana que viene os pondré tareas Es decir, necesito todos los alumnos que tengan el nombre de su ordenador asociado. Todos los alumnos que tengan un ordenador asociado. Entonces, innerjoin o leftjoin no serviría. Rightjoin no, porque yo no quiero ordenadores que no tengan alumnos. Pero por otro lado, si os digo, oye, quiero el listado de ordenadores y si tienen alumno asignado o no. entonces en ese caso sí que habría que utilizar RayJoy ¿vale? ¿sí? bien vamos a probar un par de ejemplos hay una tabla también que es la tabla de matrícula ¿vale? que está relacionada con estas tablas y aquí mi primera pregunta a vosotros es ¿cuál es la clave primaria? Hay día de asignatura. ¿Cuál? ¿Profe? Hay día de asignatura. No, está repetida. Hay día de asignatura. También se repetía. Es una trampa, ¿vale? Esto es una trampa. En este caso no hay una clave primaria como tal. Esta tabla está mal diseñada. Pongámoslo así. Una pregunta que solo hacéis, por eso la he hecho de esta manera. Bien, si quisiésemos una clave primaria, podríamos crearla, ¿vale? Que sería una concatenación de estos tres, ¿vale? Porque sería como la relación entre alumno, asignatura y profesor, ¿vale? Seguramente el año. Pero, olvidémonos, no es el caso, ¿vale? Lo que sí sabemos es que aquí hay tres claves ajenas, ¿verdad? Tenemos la de alumno, la de asignatura y la de profesor. Por lo tanto, nosotros podemos combinar con todas esas tablas. Lo cual viene el segundo punto. ¿Vale? Podemos combinar con más de una tabla. Podemos combinar con todas las tablas que necesitemos. ¿Vale? Primero, vamos a combinar matrícula con alumno. ¿Vale? Por lo tanto, lo primero que siempre decimos. Primera tabla, alias, MA. Después, inner join. Por empezar con alguno, alumno. Lo voy a llamar AL. ¿Vale? Y aquí especifico que de matrícula el número de alumnos sea igual al número de alumnos de aquí. Ahí va. ¿Qué ha pasado? No me devuelve nada. ¿Dónde me he equivocado? ¿Qué me lo dice? ¿Dónde he cometido el error? Estos errores son muy típicos. ¿Nadie? ¿Dónde está el error? En la condicional Después del punto de alumnos Aquí, ¿y cuál es? El NH NH, es decir, le estoy diciendo Un campo NH que sea igual Al número de alumnos, es decir, ahí las claves no casan Por eso no devuelve nada ¿vale? efectivamente yo aquí me he equivocado tiene que ser el número de alumno bien, claro, si yo utilizo inner join me devuelve 54 registros pero por si acaso voy a probar con nosotros, ¿vale? si especifico right join me devuelve 54 y si especifico left join ojo, me devuelve 58 ¿qué quiere decir esto? Parece que aquí, aparte de que los datos dentro puedan variar, ya utilizando diferentes joins, ya hay algo que no casa, hay algo que no cuadra. ¿Qué me dice el qué? En términos normales, ¿qué significa esto? Que hay más personas matriculadas que alumnos. Sí, efectivamente, es decir, hay parece ser alumnos que están matriculados pero que no tienen registros en la tabla de alumnos ¿vale? Y ahora os pregunto aquí podríamos saber, mirando los datos ¿cuántos alumnos son los que están en matrícula pero no están en la tabla de alumnos? ¿Cuántos? ¿Nadie? ¿Cuatro que están ahí? ¿Cuatro? ¿Por qué pensáis que son cuatro? Porque hay cuatro nulos, ¿verdad? Sí. Yo creo que son uno más. ¿Sí? Perdón, perdón. David, dime. ¿Cuántos son? Creería que es uno. ¿Uno? ¿Por qué? Porque se están repitiendo los códigos. Porque cambió el trimestre. No. Aunque hay... Fijaros. La clave es que utilizamos número de alumno y número de alumno, ¿verdad? Pero, ¿qué ocurre? Si nosotros no vamos a matrícula. Es el mismo alumno. Exacto. Es decir, cuidado, que he hecho matrícula. Aquí puede haber diferentes reacciones, pero efectivamente el alumno que por alguna razón no está en la tabla de alumno, es el alumno 2, 2, 5. Esto puede ocurrir incluso en la vida real, que haya un fallo de desencoñización. Obviamente, esto yo lo he hecho así para analizar. Bien, entonces, ahora os pregunto ¿qué es lo correcto? ¿InnerJoy o LeftJoy? Pues todo depende de lo que se solicite. Efectivamente. Es lo que os he estado diciendo también durante toda la clase, lo que ha dicho el compañero. Depende. Depende de lo que os pidan. Imaginad que os dicen, oye, que hay información de las matrículas, es decir, todas las matrículas que hay y después la información del alumno. En ese caso utilizaríamos el join porque el dato principal que nos piden es el dato referente a matrículas. O si os piden, oye, el listado de alumnos y su calificación, pues empezarías por la tabla de alumnos y después con matrículas. Por lo tanto, un in-ex-join valdría. Por lo tanto, no es que haya una solución correcta o incorrecta sino que efectivamente depende de lo que nosotros queramos obtener ¿vale? bien, para que esto no sea tan pesado yo voy a simplemente ir filtrando ya diferentes atributos ¿vale? para que al cabo no tengamos todo esto lleno de datos que después no queramos ¿vale? por lo tanto me voy a quedar con los importantes de matrícula ¿Vale? Y adicionalmente, de la tabla de alumno, me voy a quedar con el nombre del alumno, la fecha de nacimiento, y el número de hermanos. ¿Vale? NH hace referencia al número de hermanos. Aquí, por ejemplo, nosotros sabemos a qué hace referencia, pero si le pasamos esta información a alguien, NH no sabrá lo que es. Por lo tanto, vamos a utilizar un alias, vamos a especificar número de alias. Bien, ahora teníamos más claves ajenas, como por ejemplo la de asignatura. Entonces, ¿qué ocurre? Puedo combinar más tablas. Perfectamente. Después de hacer la primera combinación, continúa con otra tabla más. En este caso, asignatura. Le especifico un alias, así, en este caso, y especifico así. Y de asignatura, igual a, y ojo, y de asignatura, ¿dónde está? ¿En alumno o en matrícula? Porque aquí tenemos dos tablas, es decir, asignatura tenemos la posibilidad de combinar o con matrícula o con alumno, pero solo una. tiene la clave correcta cuál es matrícula de matrícula eso es y vamos a hacer la misma prueba haciendo los tres yo en diferentes a ver si cambia el resultado en el yo en 58 levi hoy 58 write join 58 así que en principio aquí parece que no hay registros que desentonen, en principio entonces vamos a dejarlo así y vamos a especificar así, nombre que será el nombre de asignatura y así creemos vale ejecuto y bien Ahora, ¿puedo combinar otra tabla más? Sí, la última que puedo combinar, ¿cuál es? La de profesor. ¿Vale? Es decir, con la tabla, su alias, onprprofesoride, sea igual a matrículaprofesoride. Y de aquí quiero el nombre y la nacionalidad. Si ejecuto esto, fijaros, hemos pasado de 58 a 44 con INE. Si yo mantengo el LEFT, tengo 58. ¿Por qué pasa esto? Pensad a lo que hemos hecho antes Cuando estábamos con profesores y asignaturas ¿Qué ha pasado? Que hay asignaturas que no tienen profesores Eso es Entonces, ¿aquí qué utilizo? ¿Left o inner? Pues depende de Lo que me pida ¿De acuerdo? Mirad, os voy a pasar Este script lo poco que hemos hecho al chat, ¿vale? Porque esto sí que no me importa que lo tengáis. Y ahora bien, el tema de la combinación de tablas es fundamental, ¿vale? Es decir, rara vez en la vida vais a hacer una query de una sola tabla, ¿vale? O incluso de dos tablas o tres. Normalmente vais a utilizar bastantes. por lo tanto, entender y practicar es fundamental, no por nada sino porque si cometéis un error, investigad por qué lo estáis cometiendo o por qué no te sale el resultado o por qué sale un error, por lo tanto de cara a la semana que viene no voy a poner ningún ejercicio pero por favor, de estas consultas que hemos hecho, escribidlas ojo, escribidlas vosotros mismos e id probando cambiar las claves oye, ¿qué pasa si las claves no coinciden? ¿Qué pasará? Pues que no nos devolverá nada. ¿Vale? ¿Qué pasa si cambio el orden de las tablas? ¿Qué pasa si cambio el orden de las claves? Eso con 10-15 minutos, ¿vale? Con que trachéis un poco es suficiente. ¿Vale? Pero necesito que entendáis que todo lo que hemos dicho el primer día con el tema de las claves al final se vuelca aquí. ¿Vale? Y la mejor manera de entenderlo es probando. Probando combinar. O mejor todavía, probando equivocarse. Oye, ¿qué pasa si hago esto? ¿vale? entonces con que dedique 10-15 minutos estará bien ¿vale? ¿por qué? porque la semana que viene si lleguemos, todavía nos quedan unas pocas cláusulas pero que igualmente la semana que viene, aparte de corregir la actividad 1 os subiré ya una pequeña base de datos con ejercicios ¿vale? que yo iré pidiendo entonces ya ahí empezará también la parte vuestra de práctica por vuestra cuenta pero que igualmente nosotros después a la otra semana corregiremos ¿vale? un poco con la dinámica como he estado haciendo, solo que os preguntaré todavía más, ¿vale? Y también vamos a empezar a hacer algo que yo suelo llamar como... Digo el plato, ¿vale? Es decir, vamos a primero descartar lo que no hay que hacer y después terminaremos aplicando lo que hay que hacer, ¿vale? Y se va a hacer un poco la manera de corrección. Pero bueno, tampoco os quiero dar demasiados detalles todavía, porque bueno, ya una vez que empecemos ya a partir de la semana que viene que yo mande ejercicio, ya iré moviendo, ¿vale? Por lo tanto, lo único que os pido es que por favor practiquéis lo que hemos visto, ¿vale? Con la grabación, incluso con los códigos que yo he pasado y así la semana que viene continuaremos, ¿vale? Y ya seguramente terminemos lo que es la primera parte que son las funciones estas básicas, ¿de acuerdo? Y nada, no sé si alguien tiene alguna duda, alguna pregunta nada, profe, super claro vale, perfecto igualmente, vale, los que, si alguno está un poco más perdido la cuenta, no pasa una consulta, si, dime Rafael, dime, no he revisado la actividad 2, pero es ya tiene que ver con hacer un escribo, no, no, efectivamente la actividad 2, vale, que ya hablaremos más adelante de ella, yo os voy a dar una base de datos os voy a preguntar 9 consultas y vosotros vais desde que escribir el código para obtener la información que yo os pido en esas consultas, es decir, simulación de vida real, ¿vale? pero no os preocupéis que hablaremos de ello obviamente antes de la actividad vais a tener bastantes actividades similares igual que hemos hecho con la 1, ¿vale? en la que yo os daré una base de datos y os pediré que hagáis X consultas ¿vale? es decir, que vais a estar preparados para la actividad 2 igual que la estabais para la 1, ¿vale? y vais a tener práctica de sobra ahora mismo porque lo estamos viendo las funciones, entonces claro, hablo más yo y es un poco también más monólogo pero en el momento que yo os mande las bases de datos y los requerimientos de datos que yo os pida pues obviamente vosotros vais a tener que hacerlo entonces vais a ir aprendiendo, eso ya va a ser más forzado, igualmente en la clase de corrección interactuaremos aún más todavía, ¿vale? ¿Sí? Bien, perfecto, pues nada poco más os deseo a todos una muy buena semana ¿de acuerdo? y nos vemos la semana que viene ¿vale? que la semana que viene será ya de hora y media la clase ¿de acuerdo? nada, un saludo a todos cuidaos mucho, hasta luego buena semana hasta luego
