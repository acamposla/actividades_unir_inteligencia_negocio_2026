library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.3, cex = 0.4)
# Importancia de variables
modelo_arbol$variable.importance
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.4, cex = 0.4)
# Importancia de variables
modelo_arbol$variable.importance
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.4, cex = 0.3)
# Importancia de variables
modelo_arbol$variable.importance
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.2, cex = 0.3)
# Importancia de variables
modelo_arbol$variable.importance
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.8, cex = 0.3)
# Importancia de variables
modelo_arbol$variable.importance
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.8)
# Importancia de variables
modelo_arbol$variable.importance
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.6)
# Importancia de variables
modelo_arbol$variable.importance
confusionMatrix(as.factor(pred_arbol), as.factor(test$Outcome))
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(Outcome ~ ., data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol, tweak=1.6)
# Importancia de variables
modelo_arbol$variable.importance
pred_arbol <- predict(modelo_arbol, newdata = test, type = "class")
confusionMatrix(as.factor(pred_arbol), as.factor(test$Outcome))
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(caret)
library(dplyr)
library(glue) # para hacer fstring
getwd()
diabetes <- read.csv("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R/datasets/diabetes.csv")
# cuántas filas y columnas tienes
glue("el número de filas es {nrow(diabetes)}")
glue("el número de columnas es {ncol(diabetes)}")
# Qué tipo de dato tiene cada variable
glue("Aqui se pueden ver el tipo de variables {str(diabetes)}")
diabetes <- read.csv("diabetes.csv")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(caret)
library(dplyr)
library(glue) # para hacer fstring
getwd()
diabetes <- read.csv("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R/datasets/diabetes.csv")
# cuántas filas y columnas tienes
glue("el número de filas es {nrow(diabetes)}")
glue("el número de columnas es {ncol(diabetes)}")
# Qué tipo de dato tiene cada variable
glue("Aqui se pueden ver el tipo de variables {str(diabetes)}")
diabetes <- read.csv("diabetes.csv")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(caret)
library(dplyr)
library(glue) # para hacer fstring
getwd()
diabetes <- read.csv("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R/datasets/diabetes.csv")
# cuántas filas y columnas tienes
glue("el número de filas es {nrow(diabetes)}")
glue("el número de columnas es {ncol(diabetes)}")
# Qué tipo de dato tiene cada variable
glue("Aqui se pueden ver el tipo de variables {str(diabetes)}")
knitr::opts_chunk$set(echo = TRUE)
getwd()
#library(readxl)
#datos <- read_excel("archivo.xlsx")
getwd()
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R/Simulacros")
#library(readxl)
#datos <- read_excel("archivo.xlsx")
getwd()
setwd("/Users/alejandrocamposlamas/Desktop/examen_R)
#library(readxl)
#datos <- read_excel("archivo.xlsx")
getwd()
setwd("/Users/alejandrocamposlamas/Desktop/examen_R)
getwd()
getwd()
setwd("/Users/alejandrocamposlamas/Desktop/examen_R")
getwd()
getwd()
getwd()
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R")
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R")
library(readxl)
datos <- read_excel("datasets/diabetes_dataset.xlsx")
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R")
library(readxl)
datos <- read_excel("datasets/diabetes_dataset.xlsx")
View(datos)
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R")
library(readxl)
datos <- read_excel("datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
View(datos)
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R")
library(readxl)
datos <- read_excel("datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/alejandrocamposlamas/Proyectos/ACTIVIDADES_UNIR/Estudiar_R")
library(readxl)
datos <- read_excel("datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
datos <- read_excel("diabetes_dataset.xlsx")
pwd()
getwd()
library(readxl)
datos <- read_excel("diabetes_dataset.xlsx")
getwd()
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
knitr::opts_chunk$set(echo = TRUE)
#| eval: false
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
| eval: false
eval: false
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
eval: false
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
colSums(isna(datos))
colSums(is.na(datos))
colSums(datos == 0)
# cuantas registros son 0
colSums(datos == 0)
# limpiar
datosf <- datos[datos$BMI != 0 & datos$Glucose != 0, ]
# cuantas registros son 0
colSums(datos == 0)
# limpiar
datosf <- datos[datos$BMI != 0 & datos$Glucose != 0, ]
View(datosf)
# cuantas registros son 0
colSums(datos == 0)
# limpiar
datosf <- datos[datos$BMI != 0 & datos$Glucose != 0, ]
colSums(datosf == 0)
# cuantas registros son 0
colSums(datos == 0)
# limpiar
datosf <- datos[datos$BMI != 0 & datos$Glucose != 0, ]
colSums(datosf == 0)
# cuantas registros son 0
#colSums(datos == 0)
# limpiar
datosf <- datos[datos$BMI != 0 & datos$Glucose != 0, ]
colSums(datosf == 0)
datosf$Outcome
#poutcom1 <- datosf %>% filter(datosf$Outcome == "Si")
#poutcom0 <- datosf %>% filter(datosf$Outcome == 0)
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
library(dplyr)
library(readxl)
datos <- read_excel("../datasets/diabetes_dataset.xlsx")
datos <- datos[, -1]
# View(datos)
str(datos)
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
poutcom1
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
poutcom1
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
print(nrow(poutcom1))
print(nrow(poutcom0))
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
print(nrow(poutcom1))
print(nrow(poutcom0))
porcdiabe1 = nrwo(poutcom1) / nrwo(datosf)
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
print(nrow(poutcom1))
print(nrow(poutcom0))
porcdiabe1 = nrow(poutcom1) / nrow(datosf)
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
print(nrow(poutcom1))
print(nrow(poutcom0))
porcdiabe1 = nrow(poutcom1) / nrow(datosf) * 100
print(porcdiabe1)
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
print(nrow(poutcom1))
print(nrow(poutcom0))
porcdiabe1 = nrow(poutcom1) / nrow(datosf) * 100
print(porcdiabe1)
prop.table(datosf$Outcome)
poutcom1 <- datosf %>% filter(datosf$Outcome == "Sí")
poutcom0 <- datosf %>% filter(datosf$Outcome == "No")
print(nrow(poutcom1))
print(nrow(poutcom0))
porcdiabe1 = nrow(poutcom1) / nrow(datosf) * 100
print(porcdiabe1)
prop.table(table(datosf$Outcome))
pacover50 <-datosf %>% filter(datosf$Age > 50)
nrow(pacover50)
pacover50 <-datosf %>% filter(datosf$Age > 50 & poutcom1 )
pacover50 <-datosf %>% filter(datosf$Age > 50 & datosf$Outcome == "Sí")
nrow(pacover50)
pacover50out1 <-datosf %>% filter(datosf$Age > 50 & datosf$Outcome == "Sí")
nrow(pacover50out1)
pacover50 <-datosf %>% filter(datosf$Age > 50)
propover50 <- pacover50out1 / pacover50 * 100
pacover50out1 <-datosf %>% filter(datosf$Age > 50 & datosf$Outcome == "Sí")
nrow(pacover50out1)
pacover50 <-datosf %>% filter(datosf$Age > 50)
propover50 <- nrow(pacover50out1) / nrow(pacover50) * 100
print(propover50)
mean0out <- datosf %>% groupby(Outcome) %>% summarize (media =     mean(Glucose))
mean0out <- datosf %>% group_by(Outcome) %>% summarize (media =     mean(Glucose))
mean0out <- datosf %>% group_by(Outcome) %>% summarize (media =     mean(Glucose))
mean0out
bmi30gluc140 <- datosf >%> filter(BMI > 30 & Glucose > 140 & outcome= "Sí")
bmi30gluc140 <- datosf >%> filter(datosf$BMI > 30 & datosf$Glucose > 140 & datosf$outcome= "Sí")
bmi30gluc140 <- datosf >%> filter(datosf$BMI > 30 & datosf$Glucose > 140 & datosf$Outcome= "Sí")
bmi30gluc140 <- datosf >%> filter(datosf$BMI > 30 & datosf$Glucose > 140 & datosf$Outcome= "Sí")
bmi30gluc140 <- datosf >%> filter(datosf$BMI > 30 & datosf$Glucose > 140 & datosf$Outcome== "Sí")
bmi30gluc140 <- datosf >%> filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
exam  <- datosf >%> filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
datosf >%> filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
datosf %>% filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
bmi30glu140out1 <-datosf %>% filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
bmi30glu140out1 <-datosf %>% filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
nrwo(bmi30glu140out1)
bmi30glu140out1 <-datosf %>% filter(BMI > 30 & Glucose > 140 & Outcome== "Sí")
nrow(bmi30glu140out1)
bmi30glu140out1 <-datosf %>% filter((BMI > 30 & Glucose > 140) & Outcome== "Sí")
nrow(bmi30glu140out1)
datos_num <- datosf %>% select_if(is.numeric)
cor(datos_num)
datosf$diabetes_num <-ifelse(datosf$Outcome == "Sí", 1, 0)
datosf$diabetes_num <-ifelse(datosf$Outcome == "Sí", 1, 0)
datosf
set.seed(123)
library(caret)
#index <- createDataPartition(diabetes_num)
help.createDataPartition
set.seed(123)
library(caret)
#index <- createDataPartition(diabetes_num)
createDataPartition.help
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- [index,]
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- [index, ]
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- datosf[index, ]
test <- datosf[-index, ]
print(index)
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- datosf[index, ]
test <- datosf[-index, ]
datosf
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- datosf[index, ]
test <- datosf[-index, ]
regresionlogit <- glm(diabetes_num ~ Glucose, BloodPressure,BMI, Age, DiabetesPedigreeFunction, data=train, family=binomial)
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- datosf[index, ]
test <- datosf[-index, ]
regresionlogit <- glm(diabetes_num ~ Glucose + BloodPressure + BMI+ Age + DiabetesPedigreeFunction, data=train, family=binomial)
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- datosf[index, ]
test <- datosf[-index, ]
regresionlogit <- glm(diabetes_num ~ Glucose + BloodPressure + BMI+ Age + DiabetesPedigreeFunction, data=train, family=binomial)
regresionlogit
set.seed(123)
library(caret)
index <- createDataPartition(datosf$diabetes_num, p = 0.8, list = FALSE)
train <- datosf[index, ]
test <- datosf[-index, ]
regresionlogit <- glm(diabetes_num ~ Glucose + BloodPressure + BMI+ Age + DiabetesPedigreeFunction, data=train, family=binomial)
summary(regresionlogit)
exp(coef(modelo_glm$Glucose))
exp(coef(regresionlogit$Glucose))
exp(coef(regresionlogit))
prob_individuo <- predict(
regresionlogit,
newdata = data.frame(
Glucose = 150,
BloodPressure = 80,
BMI = 33,
Age = 45,
DiabetesPedigreeFunction = 0.5.
prob_individuo <- predict(
regresionlogit,
newdata = data.frame(
Glucose = 150,
BloodPressure = 80,
BMI = 33,
Age = 45,
DiabetesPedigreeFunction = 0.5
),
type = "response"
)
prob_individuo <- predict(
regresionlogit,
newdata = data.frame(
Glucose = 150,
BloodPressure = 80,
BMI = 33,
Age = 45,
DiabetesPedigreeFunction = 0.5
),
type = "response"
)
prob_individuo
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
#pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
#confusionMatrix(as.factor(pred_glm), as.factor(test$var_objetivo), positive = "1")
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_prob
#pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
#confusionMatrix(as.factor(pred_glm), as.factor(test$var_objetivo), positive = "1")
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
#confusionMatrix(as.factor(pred_glm), as.factor(test$var_objetivo), positive = "1")
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
pred_glm
#confusionMatrix(as.factor(pred_glm), as.factor(test$var_objetivo), positive = "1")
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$Outcome), positive = "1")
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$Outcome), positive = "1")
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
confusionMatrix(
factor(pred, levels = c(1, 0)),
factor(test$var_objetivo, levels = c(1, 0))
)
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
confusionMatrix(
factor(pred, levels = c(1, 0)),
factor(test$diabetes_num, levels = c(1, 0))
)
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
confusionMatrix(
factor(pred_glm, levels = c(1, 0)),
factor(test$diabetes_num, levels = c(1, 0))
)
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
confusionMatrix(
factor(pred_glm, levels = c(1, 0)),
factor(test$diabetes_num, levels = c(1, 0), positive = "1")
)
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
library(caret)
pred_prob <- predict(regresionlogit, newdata = test, type = "response")
pred_glm <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_glm), as.factor(test$diabetes_num), positive = "1")
library(NbClust)
library(factoextra)
datos_cluster <- datos %>% select_if(is.numeric)
datos_scaled <- scale(datos_cluster)
library(NbClust)
library(factoextra)
datos_cluster <- datos %>% select_if(is.numeric)
datos_scaled <- scale(datos_cluster)
resultado_nb <- NbClust(datos_scaled, min.nc = 2, max.nc = 8, method = "kmeans")
library(NbClust)
library(factoextra)
datos_cluster <- datos %>% select_if(is.numeric)
datos_scaled <- scale(datos_cluster)
resultado_nb <- NbClust(datos_scaled, min.nc = 2, max.nc = 8, method = "kmeans")
modelo_km <- kmeans(datos_scaled, centers = 3, nstart = 25)
library(NbClust)
library(factoextra)
datos_cluster <- datos %>% select_if(is.numeric)
datos_scaled <- scale(datos_cluster)
resultado_nb <- NbClust(datos_scaled, min.nc = 2, max.nc = 8, method = "kmeans")
modelo_km <- kmeans(datos_scaled, centers = 3, nstart = 25)
# 6. Ver centros de cada cluster (para interpretar)
modelo_km$centers
# 7. Visualizar clusters
fviz_cluster(modelo_km, data = datos_scaled)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(var_objetivo ~ Glucose + BloodPressure + BMI+ Age + DiabetesPedigreeFunction, data = train, method = "class")
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(var_objetivo ~ Glucose + BloodPressure + BMI+ Age + DiabetesPedigreeFunction, data = train, method = "class")
library(rpart)
library(rpart.plot)
# Crear modelo — method="class" OBLIGATORIO para clasificación
modelo_arbol <- rpart(diabetes_num ~ Glucose + BloodPressure + BMI+ Age + DiabetesPedigreeFunction, data = train, method = "class")
# Visualizar
rpart.plot(modelo_arbol)
# Importancia de variables
modelo_arbol$variable.importance
pred_prob <- predict(modelo_arbol, newdata = test, type = "response")
pred_prob <- predict(modelo_arbol, newdata = test, type = "response")
pred_prob <- predict(modelo_arbol, newdata = test, type = "class")
pred_arbol <- ifelse(pred_prob >= 0.5, 1, 0)
confusionMatrix(as.factor(pred_prob), as.factor(test$diabetes_num), positive = "1")
