El siguiente audio en español de España), con puntuación correcta. pero con árboles de decisión, ¿vale? Porque lo vais a necesitar para la actividad número 2. Entonces, sin más dilación, voy a poner el chat como siempre en esta pantalla y os empiezo a compartir pantalla. Comenzaremos con la actividad número 2 y luego iremos con el tema de los árboles de decisión, ¿vale? Entonces os voy a poner por aquí el chat, os pongo por aquí, en la actividad número 2. bueno, dentro de esta actividad número 2 se trata en realizar los modelos de clasificación la actividad número 1 se basaba en ver un poquito lo que sería el análisis de los datos y modelos más bien de regresión y de arimas, de predicciones extemporales y en este caso estaremos hablando más de esta última parte que hemos visto de regresión logística y también de árboles de decisión que al final es lo mismo pero es otra forma de hacer clasificación En nuestro caso tendríamos el dataset que también os lo damos aparte, es un dataset en este caso de una empresa de telecomunicaciones y la idea es intentar ver información relacionada con el comportamiento de los clientes. La idea en este caso es primero poder hacer una división como hemos hecho en clase, de lo que sería el conjunto de entrenamiento y el conjunto de testeo, de una razón de un 80-20, 80% entrenamiento y 20% testeo. Este sería el primer apartado, es cuando nosotros hacíamos el train y el test, que hacíamos una división, pues sería en este caso lo que estamos comentando aquí. Una vez que hayamos hecho esto y para realizar esto, el primer paso evidentemente es ver si hay datos nulos, eliminar los datos nulos, ver si tenemos variables categóricas que hay que pasarlas a variables de tipo factor y luego podríamos hacer esta descomposición entre entrenamiento y testeo. Recordad que no solo es entrenamiento y testeo sino que aparte tenemos que decir qué variable queremos predecir, que es la variable que nosotros representábamos con i latina o la variable que iba a ser la variable independiente a la hora de realizar las regresiones logísticas. Por otra parte necesitaremos aplicar dos modelos de clasificación El modelo Logit que es básicamente la regresión logística que hemos utilizado hasta ahora Cuando escribíamos el GLM pues se basa en utilizar este modelo que hemos visto en clase Y que hoy repasaremos rápidamente, de hecho no lo programaré en tiempo real pero veréis que lo repasaremos Y el árbol de decisión que aprenderemos a utilizarlo ahora No tenemos que utilizar todas las variables, de hecho aquí ya decimos las variables que tenemos que utilizar, en este caso serían variables como el contrato, la factura digital, el servicio de internet, el soporte técnico, pero ya os damos las propias variables para que no tengáis que utilizar todas las variables que hay dentro del dataset. el tercer punto es que una vez que tengamos los dos modelos y tengamos las dos matrices de confusión vosotros seáis capaces de analizar cuál es el que tenga la mayor precisión básicamente sacar las matrices de confusión y dentro de las matrices de confusión habíamos visto una métrica que se llamaba la acuracy pues la que tenga un mayor valor de ese nivel de acuracy pues tendrá una mayor precisión Y por último, cómo se podría obtener una clasificación de la importancia de las variables en nuestro modelo, que esto lo vamos a ver ahora cuando veamos el árbol de decisión, porque de hecho con árboles de decisión es bastante sencillo obtener este cuarto punto. Entonces, en este sentido, esta sería la actividad. Como siempre os digo, también mirad lo que serían los criterios. El criterio 1, el criterio 2 y el criterio 4, porque en función de esto es como en principio se os tendría que evaluar. De acuerdo. Entonces, ¿alguien tiene alguna duda? Sí, dime. Sí, yo tengo una. Sí. Lo que pasa es que en la actividad 1 me tuve una clasificación de 8, la cual no es mala, pero dije, la observación que me hicieron fue como que mis justificaciones no eran muy extensas. ¿Vale? Yo me iba, por decir así, al grano, así como no escribía mucho, las explicaciones no eran... Lo revisaré, reviso el tuyo y lo trato con ellos, ¿vale? Solo digo que... No, no, no, no, no. No digo que estoy solicitando una recorrección. Solo estoy preguntando de qué manera usted escribiría las respuestas así como... Porque yo dije ya, si la revisión lineal, no sé, los símbolos negativos, decía como... Yo escribía en pocas palabras no hay una relación directamente proporcional entre las dos variables en cuestión. Y listo. Solamente eso escribía. pero no, parece que querían que explicara aún más. Y también me dijeron, explique qué subvariantes cree. Sí, creerá subvariantes, pero no las expliqué, por qué las creo, por qué las escribí en el Word. O sea, no tenía mi duda de qué es lo que uno debe plasmar escrito. Vale, aquí depende, porque si hubiese sido probablemente, o sea, como son otros profesores los que os corrigen, puede que tengan otros criterios. Para mí y en las asignaturas en las cuales yo corrijo, tu justificación para mí es correcta, ¿vale? Me imagino que te estás refiriendo a que tenías correlación prácticamente nula y entonces dijiste que no había ninguna relación entre las variables, probablemente justificado porque la correlación te daba muy pequeña, ¿vale? Correcto. Para mí está correcto, ¿vale? Sí que a lo mejor querían que pusieses también porque el coeficiente de correlación era 0,04, por ejemplo, ¿vale? O sea, que a lo mejor querían que pusieses en la propia explicación el valor de la correlación. Al final, bueno, esto lo miraré. También te ha pasado a ti lo mismo, ¿no, Freddy? Lo miraré. Vale, vale. Me apunto vuestros nombres. No he podido mirarlo porque he estado con 38 y medio de fiebre, ¿vale? Hasta ayer, de hecho. Entonces, me apunto y los miro con cariño, ¿vale? Por el tema de que al final, como somos profesores distintos los que hacemos la teoría o los que damos las clases de los profesores que corrigen, pues bueno, lo miro para poder comentarlo con ellos, ¿vale? vale, a todos os ha pasado lo mismo el tema de las justificaciones nos han dado, bueno veo que hay varias personas que el tema de los vale, el tema no os preocupéis lo miro en general con ellos, voy a intentar mirarlo en general y les voy a intentar comentar este tema, porque sí que es cierto que nos pedían hacer todo vale, misma duda misma duda, el tema de las sumuestras, a ti en el tema de sumuestras también te pidieron como más información, Sebastián, ¿puede ser? Soy de tomas, imágenes y visualizaciones. Vale, aquí lo reviso con ellos, con el equipo corrector y lo vamos mirando, a lo mejor falta mejor explicación y desarrollo. Vale, aquí es que depende mucho del criterio que tenga la persona, o sea, yo por ejemplo, la justificación que me ha dado el compañero, a mí personalmente si yo corrijo algo me sirve porque al final es que no hay mucho más, no te voy a pedir escribirme un párrafo para una cosa que realmente es una línea y ya queda bastante claro, ¿vale? Pero bueno, aquí vale, la submuestra me pidió una razón de por qué la hice vale, la submuestra te refieres a que hiciste un pequeño subconjunto probablemente para hacer la regresión con un test training, ¿puede ser? Es esta parte, o sea, lo que estamos haciendo del training y testing ¿puede ser? vale no os preocupéis porque lo trato con ellos a lo largo de, si no es esta semana o la siguiente si están todavía, ¿vale? para que poder entender un poquito mejor por qué es e intentar llegar a una solución más o menos correcta, ¿vale? para todo el mundo, o sea que no os preocupéis por esto tenía pensado hacerla la semana pasada pero enfermé con 38 y medio de fiebre y me fue absolutamente imposible ni siquiera encender un ordenador pero bueno, me apunto vuestros nombres si hay alguien más que tenga alguna duda de este estilo en cuanto a la tarea me encuentro suficientemente bien para que abrir un ordenador no me dé un infarto básicamente pero sí, ya me encuentro un poco mejor lo compruebo de todas formas y me apunto vuestros nombres para gestionarlo directamente para ver un poco más por qué os han hecho eso probablemente sea simplemente un tema de concepto y ya está, entonces si es un tema de concepto lo hablaremos y bueno, os mantendré informados en el foro creo que sí para el examen, los exámenes ya están hechos y me interesa saber si estas cosas pasan para el examen también decir que no busquen a lo mejor párrafos muy extensos cuando las justificaciones son de una línea. ¿De acuerdo? Vale, pues gracias por decírmelo, porque me lo apunto y según termine la clase de hoy, mando un mensajito para intentar entenderlo mejor. De acuerdo, entonces, respecto a la actividad número 2, aparte de todo esto, ¿vale? ¿Hay alguna duda de lo que hay que hacer, de lo que no hay que hacer? Hoy haremos un ejemplo tipo, volveremos a utilizar el de Titanic para que veáis un ejemplo tipo de lo que se espera de regresión logística y luego haremos todo el tema del árbol de decisión me interesa dar los dos para que tengáis un archivo típico tipo, ¿vale? para todo el tema de la regresión logística, ¿por qué? porque regresión logística y el tema de los random forest es muy muy importante ¿vale? así que como es muy muy importante, quiero que lo sepáis bastante bien, ¿de acuerdo? Vale, entonces, ¿alguna duda respecto a lo que hay que hacer? ¿Algo que a priori os resulte muy extraño, no sepáis cómo hacerlo, os sea complicado? Podéis comentármelo, ¿eh? O más o menos todo entendido. Puede ser que no, ¿eh? vale, entiendo que todo más o menos he entendido y esto lo reviso con ellos, ¿vale? para poder saber un poco el por qué o intentar entender exactamente qué es lo que quieren, ¿de acuerdo? vale, dicho esto vamos a continuar con lo que habíamos visto que básicamente es el 0 que es lo que vamos a hacer ahora La parte de relación logística la voy a dar más menos rápida, ¿vale? Para que nos quede más tiempo para entender todo lo que sería la parte del árbol de decisión, que es la última parte que nos queda de cara a la actividad número 2, ¿vale? Entonces, la librería Titanic la vamos a utilizar para que veáis luego la comparación de los dos modelos, ¿de acuerdo? Y, bueno, lo que hacíamos era cargar los datos. Los datos tenemos aquí, los datos... De hecho, si me perdéis voy a eliminar todo esto. Fecha de la actividad. Todo el tema de fechas siempre las podéis ver. vale, bajáis hacia abajo y el día de hoy creo que aquí hay un error ah no, vale, que esta es la actividad no te se ve todo fecha vale, aquí lo tenéis actividad número 2, son 4,4 puntos fecha de entrega el 12 de enero del 2026 ¿vale, Víctor? con lo cual lo puedes ver desde aquí no os pides mucho del 11.59 el 11.59 es la hora para España, aquellas personas que estéis fuera de España y tengáis un uso horario diferente y os sale 23.59, es importante que habléis con vuestros tutores, porque vuestros tutores os van a ayudar a poner exactamente la fecha correspondiente a vuestro uso horario, ¿vale? Lo digo ya no de cara a esta asignatura sino de cara a todas las asignaturas que tengáis porque siempre es mucho más cómodo ver exactamente a qué hora cierra de vuestro país, ¿vale? Para no tener que estar haciendo luego cálculos de las 11.59 de España, es la 1 de aquí, son las 2 de aquí, son las 3 de aquí, entonces para que os pase eso, es la fecha límite de entrega. Si veis que las 11.59, ¿vale? Es muy, es muy, bueno, que tenéis esta hora y no sois de España, hablad con los doctores para que os den la hora correspondiente. De todas formas, el 12 de enero a las 11.59, 12 de enero, ¿no? Vale, el 12 de enero a las 11.59 es lunes y nosotros por norma general no tenemos clase los lunes, ¿de acuerdo? nosotros tenemos las clases los jueves ¿qué quiero decir esto? que si alguien no llega el 12 de enero y llega el 13 de enero o llega el 14 de enero no le voy a penalizar aunque que parezca que penaliza o que es fuera de plazo la entrega estará fuera de plazo porque cierra el 12 de enero pero si alguien me lo entrega el 13 de enero o el 14 de enero porque no ha podido conectarse antes que no sufra, ¿vale? no va a tener penalización y me aseguraré de que todo el mundo sepa que no va a tener esa penalización, ¿de acuerdo? Si lo entregáis evidentemente después de que lo corrija, que es el 15 de enero ahí sí que tendréis evidentemente no se os corregirá porque ya tendréis la solución y lo habéis entregado sabiendo la solución pero si lo entregáis al principio es el 12 de enero y si alguien tiene algún problema por el cual el 12 no puede y tiene que ser el 13 o el 14 no habría problema ¿vale? ¿Queda claro? Sí, profesora, muchas gracias. Sí, efectivamente, como máximo tenéis hasta el 14, ¿vale? Yo creo que hay tiempo de sobra porque ya veréis con el fichero que os dé ahora, salvo una cosita que ya hemos visto anteriormente, es prácticamente lo mismo, ¿vale? Así que no deberíais tener ningún tipo de problema, pero bueno. igualmente cualquier cosa, cualquier duda siempre podéis comentarla dicho esto, vamos de nuevo a actividad perdonad que es esto de aquí, que lo otro es para otra asignatura entonces siempre los datos, tenemos que intentar mirar un poco como son los datos perdonad que no he ejecutado esta tenemos que mirar un poco como son los datos ¿de acuerdo? esto siempre os lo recomiendo también en el examen aunque implícitamente no venga escrito, siempre intentad hacer los tridatos los sumaridatos para tener información de trase aunque no os lo pidan porque queda bastante bien y suele gustar bastante y no lo digo por esta asignatura, el próximo cuatrimestre cuando demos la asignatura nueva que va a haber que es análisis masivo de datos 2 que creo que será en Python, aunque no estoy de todo segura, puede que sea también en R, pero que veremos bastantes cosas mucho más complicadas de lo que estamos viendo aquí, la verdad, o sea, sí que vais a notar bastante el cambio. Sí que os pediré siempre, o siempre habrá casi siempre un apartado que es análisis de los datos, porque es básico, ¿vale? Sin esto no deberíais poder hacer ninguna otra cosa. Entonces siempre hacer el STR de los datos para ver la información y también siempre viene a bien hacer el summary para encontrar información quizá que me pueda servir como por ejemplo la presencia de outliers. Lo que comentábamos de la presencia de outliers se puede hacer con Boss Plot o se puede simplemente ver cuando hay mucha diferencia entre la media y la mediana. Por ejemplo, en este caso no hay ninguno que tenga una diferencia que diga muy muy grande. aquí por ejemplo, en el caso de la tarifa fijaros que la media es 14,45 y la media es 32,20, hay una diferencia bastante grande y esto es porque hay valores probablemente atípicos, sí que es cierto que estos valores atípicos no tienen por qué ser erróneos, pueden ser perfectamente veraces y perfectamente entendibles, pero es por ejemplo un indicativo de que hay valores raros. de la misma forma lo vimos la clase pasada con el colsams del isnea podemos ver cuántos valores había nulos en este caso los valores nulos eran el age 177 y aquí tendríamos que podíamos hacer el datos limpios de esta manera yo aquí os comenté que esta manera ya visteis que la vez pasada nos dio un poquito de problemas así que también podéis hacerlo y yo siempre lo hago con el con el OMID para mí es mucho más mucho más fiable la verdad que esta forma pero bueno, desde la UNIR como siempre os digo os dicen esta forma yo prefiero que utilicéis la del OMID funciona muchísimo mejor que esta de aquí pero bueno, el día de hoy os lo pongo con esto porque es el que la UNIR pide pero si veis que os da mucho problema esto utilizaré el omit que vimos la semana pasada el omit nunca os va a dar problemas y siempre funciona y para mi gusto es el mejor que existe cuando hacemos el summary de los datos limpios aquí si nos vemos pues lo que comentábamos aquí tenemos el age en este caso y aquí nos aparece que había 177 valores nulos y en este caso no me parecía que había 177 valores nulos porque ya los he omitido. Lo mismo si hacéis el na.mit y ponéis los datos, el dataset en este caso, entre paréntesis. Te va a dar exactamente lo mismo y es mucho más sencillo de escribir que todo esto. Pero bueno, aquí cada maestrillo tiene su librillo. Pero bueno, en principio podéis utilizar las dos cosas, son igualmente correctas y funcionarán en principio las dos. Una cosa que vimos Hará ya dos o tres semanas Si no recuerdo mal Era la opción de hacer las tables Las tables lo que nos hacían Eran las tablas de frecuencia Simplemente en este caso Teníamos una columna Que era la columna survive De hecho para que veamos La columna survive bien Podíamos hacer siempre el view Datos limpios Cuando hacéis vosotros este view Acabáis con esta tabla tenemos la columna de ceros y unos ¿qué nos hacía la tabla? la tabla lo que nos hacía era contarnos cuántas veces había ceros y cuántas veces había unos ¿cuántas veces había ceros? pues 424 ocasiones ¿cuántas veces había unos? 290 entonces el cero en este caso significaba que no sobrevivieron y el uno que sí por tanto tendríamos que con esta función de tail datos limpios survive tenemos que 424 no sobrevivieron y 290 sí que lo hicieron, ¿vale? Pero a veces no queremos el número como tal en números, sino que lo queremos en porcentaje. Entonces, en este punto, o en probabilidades. En este punto tendríamos la palabra prop table. Recordad que la mayoría de las veces que trabajamos tanto con Python como con R, por norma general nunca nos van a dar porcentajes, ¿vale? Siempre nos dan lo que en matemática se llama tanto por uno. es decir, el valor entre 0 y 1. Para calcular el porcentaje, a estos valores los multiplicáis por 100, porque sí que es cierto que de manera habitual estamos más acostumbrados a decirlo en forma de porcentajes. Entonces con prop.table lo que hacemos es simplemente, aquí lo que haríamos sería 424 entre el resultado, entre los 714, si nosotros hacemos 424 entre los 714, pues nos da el primer valor que es este 05938375 y si hacemos el 290 entre los 714 nos dará este 0,4061625. En este caso, aunque no entra para esta asignatura, este dataset está desbalanceado. ¿Por qué? Porque nosotros queremos clasificar entre supervivientes y no supervivientes, y tenemos una proporción del 60-40%, no una proporción del 50-50. No entra para esta clase y no lo veremos, pero esto a veces lo que se hace es para mejorar la predicción y para asegurarnos de que de verdad clasifica por las variables y no porque haya más de un caso que de otro. muchas veces utilizan técnicas intermedias que se llaman en el smooth sobre todo que lo que hacen es crear datos ficticios para igualar y que la proporción sea de un 50 a 50 ¿vale? pero bueno esto en principio de momento no nos interesa ¿vale? Dime ¿El table funciona solo para factores o también puede ser alguna alguna columna que tenga unas 20 variables? El caso del table podéis poner todas las columnas que sean sí, sí, sí, en principio por ejemplo, vosotros tenéis por ejemplo te pongo un caso que tenga más de 0 y 1, pero por ejemplo si tenemos aquí el P-Class, que tenéis más opciones, vale si vosotros aquí hacéis la table del P-Class, pues tendréis también lo mismo table, datos lindos dólar, y ponemos aquí el P-Class una cosa, sobre todo para el ejercicio os aconsejo no escribir vosotros hasta el final el nombre de la columna sobre todo si tiene espacios entre medias, ¿vale? en este caso no lo veremos pero lo que os aconsejo es poner la inicial y darle al tabulador cuando salga la columna porque cuando tenga espacios el propio R pone una especie de comillas así, ¿vale? y a veces si las ponemos nosotros manualmente nos da problemas, ¿vale? Pero bueno, si vosotros veis esto, tenemos aquí el opción 1, opción 2, opción 3. Y si lo utilizas con otra variable que tenga 5, 6, 7 categorías, 8 categorías, 9 categorías, lo tendrás de las 5, 6, 7, 8, 9 las categorías que sean. ¿Era esto, Freddy? ¿Puede ser? Sí, eso era, gracias. Vale, también podéis hacerla de dos columnas a la vez ¿De acuerdo? No hay ningún tipo de problema En este caso os darán una tabla digamos, más bien entre comillas con las columnas y una matriz básicamente Tendréis aquí la opción en este caso por ejemplo, de cuál es un mujer, cuál es un hombre y cuáles han sobrevivido y cuáles no Una especie de matriz de confusión pero en este caso simplemente para saber cuántos casos hay de cada uno con este formato de tabla. Esto lo habíamos visto, como veis este fichero también os lo colgaré, aquí tenéis por ejemplo lo que también comentabas Freddy, por ejemplo en este caso utilizamos el tema de la edad y entonces tendríamos que los datos limpios survive con respecto a la edad. Fíjate que aparezcan todas las edades, yo creo que aquí por ejemplo estos son más bebés, pero bueno, tienes todas las edades, ¿de acuerdo? y cuántos supervivientes y cuántos fallecidos hay de cada una de las edades y lo puedes hacer incluso de tres columnas, no hay ningún tipo de problema lo que pasa que de tres columnas, fijaros que ya empieza a ser un poco más la representación no es tan buena, en el sentido de que por ejemplo la tercera columna ya nos aparece como dos tablas separadas cuando la primera columna es female y cuando la segunda columna es male pero tenemos estas opciones en clase lo habíamos visto únicamente para el caso de una columna, pero bueno para que sepáis que se puede hacer con varias columnas y con todos los valores que querías ¿vale? es bastante útil sí, os digo que no el tema de la regresión logística ¿de acuerdo? aquí es lo único que cambia para la entrega, ¿de acuerdo? recordad hacer el train test split porque es que de hecho os lo piden, ¿vale? o sea, para la entrega, recordad que habíamos hecho, hicimos el 30 split del 80, del 30 70-30, si no recuerdo mal es lo único que vais a tener que añadir de lo que vimos las anteriores semanas a este caso, ¿vale? Igualmente, también tenéis tenemos dos clases aparte, que no solo será con vuestro grupo sino que serán todos los grupos en las que os haré un repaso el 8 de enero y el 13 de enero, si no recuerdo mal os haré un repaso a todos los grupos de todo lo que se ha visto, ¿vale? Desde el principio, con lo cual tendréis, bueno, repasaremos esto de nuevo, ¿vale? Pero bueno, es lo único que tenéis que añadir al documento que tenemos ahora que os voy a dar con el árbol de decisión y todo, lo único que tendríais que añadir para la entrega que lo vimos la semana pasada, ¿vale? Entonces, en este caso la regresión logística, recordad, siempre partimos de nuestro conjunto de datos, en este caso la que queremos intentar predecir era si habían sobrevivido o no habían sobrevivido, por tanto es la primera variable que poníamos y muy parecido a la regresión lineal, el acentito de la ñ, y tendríamos que ir respecto a qué, pues si lo queremos hacer respecto a la variable edad, pues respecto a la variable edad. Sacábamos la regresión logística y con el sumar y podíamos ver cómo de bien había resultado esta regresión, ¿de acuerdo? Aquí tendríamos por ejemplo, porque lo habíais comentado en numerosas ocasiones, el tema de qué variables son las significativas, qué variables no son las significativas, pues aquí tenéis el 0,0397 y en la regresión logística la magnitud no se interpretaría exactamente igual que la regresión lineal, que esto vendría siendo el tema de los coeficientes. El tema de los coeficientes en este caso es diferente porque la fórmula no es una recta como tal sino que depende de una exponencial negativa, bueno realmente es una división donde en el denominador tenemos la exponencial negativa más un montón de cosas, pero bueno lo podemos asemejar a una exponencial negativa. Por lo tanto, no es tan fácil llegar a decir si afecta negativa o afecta positivamente, porque al final no es lo mismo que unas sumas o restas, que es bastante sencillo de entender. Dicho esto, podemos tenerlo para una única columna o podemos tenerlo para más de una columna, de la misma forma que hemos hecho en otras ocasiones. En este caso, si vamos a la variable age, vemos que en este caso la variable es mayor de 0,05 y por lo tanto es lo que comentábamos que no es significativa a priori. ¿De acuerdo? Entonces, si alguien tiene alguna duda de esto, y ahora lo estoy pasando más rápido porque lo hemos visto en numerosos días, pero si tenéis dudas, por favor comentad. Gracias. Hola, hola. Ahora sí se me escucha. Vale, perfecto. Nada, lo que os comentaba, que las variables, la regresión logística puede ser con una variable, con dos variables, con tres variables, con las que queráis. La que se predice siempre es una, ¿vale? Es decir, la que nosotros queremos averiguar, en este caso el tema de si ha sobrevivido o no, siempre es una única variable, ¿vale? Pero luego podéis utilizar 2, 3, 4, 5, 6. Si os vais a la actividad número 2, ¿Vale? Os decimos exactamente qué variables necesitáis, pero cuidado que las variables tienen espacios entre ellas, así que si vosotros escribís el nombre como espacio, a ver si tengo alguna variable aquí con espacio, para explicaros, es que esta va a estar bastante bien hecho y no va a tener espacios. Vale, imaginemos que tuviésemos una variable con espacio, ¿de acuerdo? Imaginemos que fuese Pclass, por ejemplo, aquí embarcar, ¿vale? Si vosotros lo ponéis así con el espacio, os va a dar un error, ¿vale? En R, cuando pasan estas cosas, aparece una serie de como entre comillas, comillas, que no son las comillas, sino que es el acento de tilde. es complicado encontrar exactamente cuál acento es, entonces mi recomendación, ¿vale? y esto aquí cualquiera lo que queráis si queréis lo utilizáis y si queréis no lo utilizáis pero mi recomendación poned el dólar poned la P y bueno ahora justo no ha querido hacerme caso, vale, si ponéis el dólar ponéis la P y si no os aparece poned el tabulador, ¿vale? el tabulador ¿sabéis qué tecla es? os lo muestro por pantalla un momentito, porque esto sí que si no os va a dar bastantes problemas aquellos que no estéis acostumbrados el tabulador viene siendo si tenéis teclado bueno, depende de vuestro teclado, ¿vale? esto va a ser un poco complicado con el fondo, quito un momento el fondo para que lo veáis fondo, fondo, fondo, fondo ninguno si veis aquí el tab ¿Vale? O sea, en mi parte está el tab que está encima de las mayúsculas. ¿De acuerdo? Entonces, para mí ese es el tabulador. Si vosotros dais a esa tecla, muy probablemente sí que es para poder autocompletar. ¿Vale? ¿Había una persona que ha hablado? Coméntame. Sí, yo profesora le quería preguntar si necesariamente la regresión logística se tiene que escribir así como colocando los siguientes datos hacia abajo No, no lo podéis hacer en una sola línea no, no, no eso no hay problema, de hecho personalmente, os lo pongo así para que lo veáis porque si no a veces se os queda como al final y tengo que estar moviendo de un lado a otro ¿vale? pero lo podéis hacer en una sola la línea y de hecho en mi día a día yo lo hago una sola línea, ¿vale? Aquí os lo pongo en dos porque a veces si no ponemos muchas columnas y queda como al final entonces luego no lo veis, etc. y es un poco más jaleo, ¿vale? Entonces, lo que os comentaba ponéis la P, si no se aparece automáticamente como a mí me está pasando las opciones de las columnas, le dais al tabulador que para mí en mi teclado es el que está encima del bloqueo de las mayúsculas en el teclado QWERTY que es el mío y ya me van a salir las opciones. Seleccionáis la que es y volvéis a dar al tabulador. Lo digo porque cuando tengáis el espacio os pondrá automáticamente las comillas, los acentos esos, y no os va a dar problema el hecho de que tengas el espacio en medio, sino sí que va a ser un poco más complicado a la hora de hacer. Efectivamente Efectivamente, sí, exacto Víctor, hay otras formas, ¿vale? Pero en el momento en el que estamos Que estéis empezando, hacedlo así ¿Vale? El tema de poner El dataset del cual quieras Y luego cada una de las columnas Recordad que aquí Tendréis que hacer una pequeña modificación Porque tendréis que añadir lo de Descomponer el dataset entre 80 y 20 Que lo habíamos visto otras veces A ver si al final de esta clase tenemos otra vez un poquito de tiempo para mirarlo, ¿vale? Pero sí, sí, exacto, Víctor, lo que has comentado, ¿vale? Vale, recordad también que se pone la family binomial porque la regresión logística solo podemos utilizarlo para predecir variables que son dos posibles clases, ¿de acuerdo? O cero o uno, sí y no, rojo y azul, lo que queráis, pero solo dos posibilidades, ¿de acuerdo? Mientras que el árbol de... Bueno, mientras que luego los árboles, como sería el random forest y otros tipos de árboles sí que servirán sí, pero aunque tuviesen acentos y tildes, si vosotros lo hacéis con el tabulador, ¿vale? os lo va a reconocer bien y os lo va a coger bien las columnas por lo tanto no deberíais tener problema pero por eso os comento que pongáis siempre el tabulador por el tema como ha comentado exactamente Juan, si hay acentos si hay tildes o si hay espacios siempre os aconsejo mejor el tabulador, ¿vale? porque os lo va a poner ya todo perfecto, con las comillas como tienen que ser y no vais a tener problemas en cuanto a que os reconozca la columna dicho esto de la misma forma lo podemos hacer con tres variables, no hay problema tendríamos la regresión logística después del $Pclass veo un L, ¿dónde? sí, es que había tenía puesto aquí para escribir, de acuerdo es el lo diré, el cursor sí, sí, no te preocupes, era el cursor vale, entonces, luego tenemos la regresión logística de nuevo, aquí recordad lo del 0,05 si queréis dar un poco más de detalle, pues recordad lo que habíamos dicho de la significancia, de cuando era menor de 0,05 o mayor de 0,05, vale, para que lo podáis tener en cuenta, pero bueno, en principio esto sería lo que tendríais que ver, si nos da Bueno, aquí aparte os he explicado absolutamente todo, ¿vale? De que la variable Pclash se interpreta como una variable numérica, aunque realmente aquí estamos teniendo un tipo de categoría, pero como ya me la da en formato número, lo interpreta como si fuese un número. podemos mejorarlo, podríamos llegar a mejorarlo y decirle, oye, no es un número, es un factor, ¿vale? Se podría llegar a hacer, ¿cómo? Poniendo el as facto, ¿vale? Este sería como algo bastante profundo, ¿vale? O sea, esto realmente lo que vendría siendo es que hay veces que nosotros tenemos clases, o sea, yo tengo, por ejemplo, imaginemos que hacemos grupos de equipos de fútbol, Tenemos equipos de fútbol que están en la primera división, equipos de fútbol que están en la segunda división y equipos de fútbol que están en la tercera división. Si yo mezclo todos los equipos de fútbol y tengo una columna que diga división 1, 2, 3, me lo va a interpretar como un número, pero en realidad no es un número, sino que son categorías. Entonces, en este sentido, si vosotros tenéis una columna, como es el caso de la columna Pclass, que realmente es una categoría, es decir, que realmente me está dando un identificador de un grupo, podéis decirle explícitamente que te lo trate como tal, como utilizando el as factor. es simplemente decirle oye esto no es una variable que pueda tener decimales, no es una variable numérica al uso sino que es una variable categórica que son grupos. Entonces lo haríamos con la palabra asfactor. Asfactor ya lo utilizamos anteriormente, si os acordáis lo utilizamos sobre todo cuando partíamos de variables que eran completamente de texto y las queríamos pasar a variables que eran numéricas o decir, oye, solo pueden tener dos posibles valores esta variable, ¿de acuerdo? Personalmente, aunque R sea bastante inteligente, ¿de acuerdo? Y R y algunas variables de tipo texto que las interpreta, no es lo que deberíamos hacer, ¿vale? Es decir, a vuestro nivel lo podéis dejar así. Al nivel del próximo cuatrimestre no os lo dejaré hacer así. En el sentido de, por ejemplo, la variable sexo tenemos que es masculino y femenino. Y me podríais haber dicho, es que no lo hemos pasado a factor como nos comentaste ni lo hemos pasado a numérico como nos comentaste. R es bastante inteligente y creo que esto es un punto también positivo y negativo a la vez. R es bastante inteligente y algunas variables te las va a entender bien aunque no las pases a numérico, ¿vale? Pero cuando vayamos a otros lenguajes de programación, sí que sí, siempre toda variable de tipo texto lo vais a tener que convertir en variable de tipo numérico. y por norma general el buen programador o la persona que lo hace de manera correcta hay un paso muy importante que es pasar todas las variables de tipo texto a tipo numérico. Tal como estáis en el nivel que estáis, si queréis pasar no lo podéis pasar y si os funciona sin pasarlo, os funciona sin pasarlo y no hay problema. Pero para el segundo cuatrimestre sí que entre comillas exigiré que todo se pase a numérico porque es como en realidad se tiene que funcionar para que para vosotros sea algo más fácil pasar también de RStudio a Python. Veáis que se hace exactamente lo mismo en RStudio que en Python y no nos cambiemos mucho la cabeza. Pero básicamente en R es más inteligente que Python en ese punto y lo permite. Pero la mayoría de lenguajes de programación, tipo de texto, o sea, columnas tipo texto, nunca nos la van a permitir. Y realmente las personas que se dedican a esto siempre hay un apartado que es todas las variables textuales pasadas a números. Pero bueno, para esta entrega si la queréis dejar con texto la podéis dejar con texto, pero sí que es cierto que personalmente aunque sea hacedme un asfactor. Aunque sea hacerme aquí un as factor, aunque sea ponédmelo en vez de como texto como factor. Más que nada porque os va a resultar a vosotros mejor después también de cara a futuros exámenes que hagáis y futuras asignaturas y para vuestra vida diaria la verdad es que sí que se pasa normalmente de texto a número. Cuando tenemos aquí el summary, venimos aquí de nuevo a interpretarlo un poco lo que habíamos comentado, sobre todo el tema de qué puede ser significativo, qué no es significativo, comparándolo con el 0,05 sobre todo. Y aquí tendríamos los estimadores que, bueno, en este caso, como os digo, es más complicado de interpretar que en el caso que vamos a ver. dicho esto aquí tenemos ahora que hacer una predicción ¿vale? en este caso tendríamos que se pueden hacer bastantes predicciones vosotros podéis hacer predicciones de manera aleatoria o es decir, decirle, oye simplemente hazme una predicción o podemos darle algunos datos concretos para que me haga esta predicción ¿vale? de momento No, sí, sirve para todo. Asfactor lo que te hace, os he puesto el caso del sexo, pero porque era el que tenía texto. ¿Qué hace Asfactor? Asfactor lo que hace es selecciona la columna, selecciona todas las posibles opciones que puede tomar esa columna. En este caso el sexo ha puesto dos opciones, pero si tuviésemos, por ejemplo, una columna que fuesen colores y todo fuese rojo, azul y negro, por ejemplo, pues entonces Asfactor lo que haría sería recorrer esa columna, ver que existen las opciones únicas de rojo, azul y negro y decirte tienes una columna que tiene tipo texto, pero tiene tres posibles opciones únicamente. Entonces, internamente, él ya entiende que esto es el 0, el 1, el 2, el 3. As factor solo existe también en R, ¿vale? En Python no existe as factor, por eso en Python nos vemos obligados al final a hacer el último paso que es convertirlo a numérico, ¿de acuerdo? Pero en R sí que es cierto que tenemos esta vertiente intermedia, ¿de acuerdo? Bueno, cuando tenemos que hacer la predicción, podéis hacer una predicción sobre los mismos datos y, bueno, no es lo mejor. Lo mejor es hacer el training, el test, como hemos dicho y como os piden la tarea, ¿de acuerdo? que es hacer el training, el test y luego aplicar, crear el modelo con la parte del training, del entrenamiento y aplicarlo en la parte de testeo, que esto lo hemos hecho en las clases anteriores, ¿de acuerdo? De dividirlo en conjunto de entrenamiento, conjunto de testeo, aplicar el modelo conjunto de entrenamiento y luego predecir con el conjunto de testeo, ¿vale? Esto es como realmente se hace porque no tiene mucho sentido que vosotros creéis un modelo, ¿vale? Y luego en el cual le estáis dando la solución, porque al final estáis diciendo también para crearlo, le dais la solución de lo que queréis que cree y luego le digáis que prediga cuando vosotros ya le habéis dado el resultado, ¿vale? Entonces realmente siempre se hace con el conjunto de testeo y el conjunto de entrenamiento. Pero bueno, en este caso concreto, para el repaso, os lo estoy haciendo más rápido en este sentido con esto. Entonces tenemos la predicción del modelo, hacéis la predicción y al final lo que os sale, si le dais al view o si le dais directamente aquí, es la probabilidad que tiene de ocurrencia. ¿De acuerdo? Esto como tal no son ceros y unos. Esta es la probabilidad que me sale de este valor. Entonces, por ejemplo, aquí en la línea 1 me sale un 0,10 de probabilidad, que no es ni un 0 ni un 1. Entonces, ¿qué se hace? Lo que se hace es redondearlo. Si es mayor de 0,5 digo que ha sobrevivido y si es menor de 0,5 digo que no ha sobrevivido. Entonces, lo que generalmente se hace con la regresión logística y siempre se hace es que estos valores, lo que hacemos es 0,91 está más cerca de 1, por lo tanto, vais a tener que va al 1, ¿vale? Es muy raro que os salga un 0,5 clavado, ¿vale? Así que no os vais a encontrar la disyuntiva del 0,5000000 donde vais porque es prácticamente posibilidades de una entre un millón de que os quede el 0,5 justo, ¿vale? Siempre tendréis decimales que haya que vaya hacia un lado o hacia otro. Cuando vosotros hacéis en este caso la predicción del modelo codificado, aquí ya sí tendréis estos ceros y estos urlos porque vienen del anterior de redondearlo para arriba y para abajo. La matriz de confusión la podéis crear así, que a mí personalmente no es la mejor forma, ¿vale? Y la que sí que os recomiendo es hacerlo, aunque aquí os lo pongo todo para que lo veáis y lo tengáis todo, ¿vale? Pero os recomiendo hacerlo con la librería Caret porque nos la calcula ya automáticamente y nos la calcula en condiciones. Esperad un momento que está aquí generando. Bueno, que no hay una parte que no vale esta parte de aquí. Voy a instalarlo porque yo lo tengo instalado. Vosotros tendréis que instalarlo. Y aquí me da este error. Este error que pone que es suit with factors with the same levels nos daba también la anterior vez. Recordad de cuando salga, si os sale este error, básicamente es que no lo hemos pasado a las factors. Entonces yo lo que recomiendo es pasarlo a las factors. As factor. ¿Vale? Y en principio el as factor también aquí para que no nos salga ningún tipo de problema. Si os sale el error de abajo, el data y la referencia no tienen los mismos niveles, no son factores de los mismos niveles, lo que tenéis que hacer es convertirlas las dos a factores. Y aquí ya lo tendréis. Entonces, os aconsejo hacerlo más de esta forma porque no solo tenéis la matriz de confusión, sino que tenéis la métrica de la cura. ¿Qué es la métrica? ¿Qué os piden aquí? ¿Qué modelo de clasificación tiene una mayor precisión? Entonces cuando os preguntan esto, se están preguntando implícitamente por esta métrica de la cura. ¿De acuerdo? Entonces, lo que tenéis que hacer, por eso os digo que hagáis con la librería Caret, porque cuando tengáis la matriz de confusión, no os olvidéis de los as factors, tendréis no solo la matriz de confusión de el modelo te ha predicho que es un 0 y en realidad es un 0 385 veces, ¿vale? O te ha dicho que es un 0 y es un 1 111 veces. no solo tenéis eso, sino que tenéis la matriz de la cura tenéis los coeficientes de con qué seguridad lo puedes decir pero bueno, lo importante es la cura, la sensitividad y la especificidad, entonces ya lo tenéis calculado y no tenéis que estar pensando en calcularlo con fórmulas aparte porque ya directamente os lo da esto es lo que os quería comentar también una cosa más, es lo que os comentaba podemos predecir, aquí lo que os comentaba es que aquí predeciríamos esto os lo pasaré, pero me interesaba que tuvieses un código entero más o menos hecho, ¿vale? aquí lo que hemos hecho es predecir digamos que todas las filas que ya le había dado antes al modelo para crearlo ¿vale? ya os he dicho que normalmente se hace con el test que es como lo tenéis que hacer, ¿vale? pero bueno, por otra parte podemos predecir datos completamente nuevos que esto también os lo añadí en uno de las anteriores clases, también lo tuvimos, ¿vale? Que es básicamente, le decís con qué regresión logística, con qué modelo lo queréis hacer, que en este caso es con este modelo de aquí, ¿vale? Vamos a ejecutar. Y le decís, no quiero un dato que ya tenga en mi base de datos, no quiero un dato que tenga en mi tabla, sino que quiero datos completamente nuevos. entonces en este caso el dato completamente nuevo tengo que darle de todas las columnas que estoy evaluando si estoy haciendo la regresión logística con la edad, el sexo y el P-Class cuando yo cree un nuevo valor en este caso para Leonardo DiCaprio en la película pues la edad sería 22, el sexo en este caso sería hombre y la clase en este caso era la tercera entonces si nosotros hacemos esto, la probabilidad de sobrevivir en este caso de Leonardo DiCaprio pues era de un 0,10 o sea probablemente hubiese fallecido el personaje si hubiese sido en la vida real y si tenemos la probabilidad de Kate pues podemos hacer lo mismo pero en este caso añadiríamos el tema de mujer y tendríamos aquí la probabilidad sería un tanto diferente tendríamos aquí que la probabilidad en este caso sería un 0,95 es decir que con toda la probabilidad o con casi toda la probabilidad hubiese sobrevivido ¿De acuerdo? Alguna cuestión más que tengáis para el tema de las regresiones logísticas, el tema del summary. Lo que os comentaba que se puede interpretar como una exponencial. ¿De acuerdo? No es exactamente esta la fórmula, ¿vale? De logit, pero se puede aproximar. Entonces, es exponencial de, en este caso, fijaros, si utilizamos la edad, sería del menos a 0,036985, ¿vale? Entonces, cuando nosotros generamos esta exponencial, ¿vale? Si la generamos así, las exponenciales siempre son positivas, la exponencial es 0,96, pero para nosotros saber cuánto ha afectado, tenemos que hacer 1 menos este valor, ¿de acuerdo? Entonces, 1 menos este valor y lo multiplicamos por 100, os da la posibilidad de sobrevivir. Pero bueno, esto ya es más para que lo practiquéis, esto lo subiré y así lo tendréis todo más menos, ¿vale? Y aparte lo repasaremos el 8 de enero. Dicho esto, me queda poquito, pero vamos a ello, que creo que sí nos da, porque al final veréis que es prácticamente lo mismo. Árboles de decisión. En este caso, para hacer árboles de decisión, no sé si conocéis lo que son árboles de decisión, os pongo un ejemplo bastante rápido. os pongo un ejemplo bastante rapidillo y lo vais a entender perfectamente no es algo que sea muy complicado o sea que no vais a tener problemas de hecho casi todos vosotros probablemente en algún momento de vuestra vida habéis hecho árboles de decisión esto viene siendo un árbol de decisión lo que podéis ver por pantalla entonces ¿qué es un árbol de decisión? No es más que nosotros vamos definiendo ciertas etapas en las que hacemos preguntas. Si las preguntas son positivas, llegamos a una conclusión y si las preguntas son negativas, hacemos otras preguntas o llegamos a otra conclusión. por ejemplo en este caso queremos evaluar si una persona está en buena forma física o no está en buena forma física entonces lo primero que preguntamos es ¿la edad es menor que 30? si la edad es menor que 30 entonces preguntamos otra cuestión oye ¿come pizza? si es que sí pues a lo mejor no está en la mejor forma física y si es que no a lo mejor sí que está reduciéndola a un caso muy muy sencillo ¿vale? cuando nosotros nos preguntamos si es menor de 30 años y decimos que no La siguiente pregunta es, bueno, ¿se ejercita o no se ejercita? Si es que sí, entonces está en buena forma física. Si es que no, no está en buena forma física, ¿vale? esto es un caso muy pequeñito en el cual solo hacemos como dos etapas podemos tener tres etapas, cuatro etapas, cinco etapas, las etapas que queráis pero se basa en que nosotros tenemos una serie de columnas en este caso sería la columna de la edad, la columna de si come pizza, la columna de si hace ejercicio y la columna resultado de si está en forma o no está en forma y lo que hacemos es ir estableciendo reglas según va preguntando para nosotros poder clasificar al final. Este es un claro ejemplo de un árbol de decisión. Se puede representar de esta manera, de manera esquemática y por tanto es bastante más sencillo de interpretar de lo que sería una regresión logística. ¿Se entiende ahora mejor? Sobre todo, Juan, que me has comentado que no conoces. Sí, se entiende, gracias. Al final creo que una imagen vale más que mil palabras, por eso prefiero enseñaroslo con una imagen. Entonces esto lo podemos hacer con RStudio. Personalmente los árboles de decisión a nivel básico es importante para vosotros conocerlos, pero en la realidad no se utilizan los árboles de decisión. Se utilizan unos que son, hacemos 100 árboles aleatorios de decisión y obtenemos el resultado como la media. Es lo que se llama random forest, esto lo veremos más el próximo cuatrimestre, pero para entender bien el random forest primero tenéis que entender bien el árbol de decisión, por lo tanto sí que es cierto que es necesario que al menos lo hayáis visto. Para que veáis que es exactamente muy parecido a lo que tenemos ahora, voy a copiar y pegar la regresión logística que tenía por aquí, para que veáis que el formato es prácticamente el mismo. Entonces vamos a copiar y pegar esto. Voy a ponerlo aquí abajo. ¿Y qué cambia? Lo primero que cambia es que necesito unas librerías. Recordemos que R no lo sabe todo, entonces lo primero que tenemos que hacer son las librerías. porque sí que es cierto que en el caso de árboles de decisión no están como dentro del conocimiento de R hay que decirle que lea entre comillas un libro y escoja la información relacionada a estos árboles de decisión entonces en este caso las librerías vamos a utilizar la Rpart esta es para crear el árbol de decisión pero no solo lo queremos crear, lo queremos ver lo queremos tener representado así que vamos a utilizar otra que es Rpart punto perdón punto plot vale que esto me va a permitir representarlo gráficamente y tener una mejor un mejor concepto de él vale entonces nosotros hacemos o sea ponemos las dos las dos librerías y ahora como voy a llamar al árbol para que veáis que es exactamente lo mismo simplemente aquí lo vamos a cambiar vamos a llamarlo por ejemplo modelo árbol por ejemplo y en lugar de ser el GLM, ¿qué va a ser? Va a ser Rpart. Quiero predecir de nuevo los que son survived, las columnas que son survived, la edad, el sexo, el pclass y en este caso no voy a poner ningún tipo de familia binomial porque no estoy hablando de una regresión logística, es lo único que cambia. En este caso, lo que tengo que decirle es, lo que me tienes que predecir son clases. Es 0 y 1, pero son dos categorías. Entre comillas que me lo den formato as factor para que nos entendamos. Entonces, utilizamos el método class. Una cosa importante, aquí si no os habéis dado cuenta no estoy poniendo el dataset, ¿por qué? Porque yo el dataset se lo estoy poniendo aquí como data igual a datos limpios. vosotros si os es más cómodo hacer el datos limpios dólar aquí, datos limpios dólar aquí, funciona exactamente igual ambas formas son equivalentes y funciona exactamente igual con lo cual lo que queráis, si lo hacéis así y en una pega que es cuando tengáis espacios no podréis hacer el tabulador porque no va a saber a qué os referís de momento Cuando ejecutamos esto, en principio ya estaría y de la misma manera teníamos el summary del modelo árbol. Cuando vosotros hacéis este summary del modelo árbol, aquí sí que es cierto que nos da mucha, pero bastante más información. nos dice básicamente que estamos analizando un total de 714 árboles y nos empieza a agarrar un poco más o menos cuántos ha tenido en cada uno de los nodos o en cada una de sus hojas. ¿Realmente interpretar esto? Puede costar un poco porque como veis tenemos los nodos, que serían estas cajitas que veíamos en el dibujo, Esa cada una de las cajitas de H menor que 30, eat pizza, exercises, esto matemáticamente se llama nodos. Y vendría siendo, por ejemplo, cuántas personas o cuántas predicciones ha habido en cada una de esas cajitas. Realmente lo más importante para interpretarlo no es saber esto, sino es hacer el dibujo del árbol con el R part plot. En este caso, cuidado con mayúsculas y minúsculas. del modelo árbol, lo que vamos a hacer es que me sea capaz de dibujarnos. Entonces, os lo doy aquí en el zoom. Pero para que veáis, es lo mismo que hemos sacado anteriormente o prácticamente lo mismo que hemos sacado anteriormente, solo que representado de una forma más sencilla. Pero aquí, ¿qué nos damos cuenta? Lo primero que nos damos cuenta es que al principio del todo, en el nodo principal, ¿vale? Teníamos un 100% porque eran todos los datos, ¿de acuerdo? 100%. Y la primera pregunta que nos hemos hecho es si el sexo era hombre o si era mujer. Si el sexo era hombre, hemos ido por este ladito de aquí. A ver, perdón, hace. Si hemos hombre, hemos ido por este ladito de aquí, ¿vale? Y aquí hay un 63% de los datos. Ahora hablaremos del 0,21 de arriba, ¿vale? Pero hay un 63% de los datos. Si es hombre, lo que hemos dicho ahora es, vale, la edad. En este caso, la edad que ha interpretado el algoritmo, que es lo importante para hacer la clasificación, es si es mayor o igual que 6,5 años. Si es mayor o igual que 6,5 años, fijaros que teníamos un 60% que teníamos el 0 y el 3% restante sería el 1. cuando nosotros vamos al caso de que sea mujer porque no en este caso no es hombre y sólo hay dos opciones es mujer por lo tanto tendríamos aquí que la siguiente pregunta que se hace o en el caso de las mujeres la siguiente pregunta era el tipo de la clase que tenían si eran de clase 3 o no eran de clase 3 vale entonces si eran de clase 3 lo siguiente que se pregunta es si la edad es mayor igual que 39. Fijaros además, aquí hay un caso concreto, ¿vale? Que si la edad no es mayor o igual que 39, aún así añade otro dato, que es la edad es mayor o igual que 5,5. Entonces, quiero decir, no quiere decir que solo se evalúe la columna una única vez por etapa, se pueden evaluar 2, 3, 4, 5, 6 veces, de hecho aquí, si es que sí, incluso pregunta Si es menor que 12, es decir, aquí estamos evaluando bastantes veces la misma columna, ¿vale? Pero bueno, esto sería nuestro árbol de decisión y siempre intentad hacerlo con el R-part más que nada, ¿vale? Porque es mucho más cómodo, ¿de acuerdo? Y lo vais a ver mucho mejor. Ahora, ¿cómo interpretamos este árbol de decisión? Hay tres números en cada una de las cajas, ¿vale? Tenemos el número de arriba, el número de en medio y el número de abajo, ¿de acuerdo? El número de arriba. El número de arriba lo que nos está indicando es si hay más ceros o más unos de la variable que yo quiero predecir. Por ejemplo, si nos vamos aquí, el número de arriba, este cero de arriba, lo que me está diciendo, este cero de aquí, ¿eh? Lo que me está diciendo es que a esa fecha, que todavía no he hecho ninguna división, hay muchos más ceros que unos, que lo sabíamos, porque había 424 ceros y había 200 y pico unos, ¿vale? Cuando hacemos el caso de hombre y vamos al caso del yes, aquí tenemos un cero, ¿por qué? Porque en el caso de los hombres, en esta división, en esta primera división, que solo ha sido si es hombre o si es mujer, tenemos muchos más ceros que unos, ¿vale? En este caso, ¿por qué ponemos 1? Porque en el caso de las mujeres hay más unos que ceros en esta etapa. Entonces, este primer número lo que me va indicando es en cada una de las clasificaciones si hay más ceros o más unos, ¿de acuerdo? Luego vamos al número de en medio, ¿vale? Este número de en medio, que es este 0,41, aquí tenemos este 0,21, aquí tenemos este 0,75, este número me indica el porcentaje de cuántos unos existen, ¿vale? Es decir, en el primer caso tenemos 0,41, que sería cuántos unos existen sobre 1, perdón, no porcentaje sobre 100%, sino sobre 1. Tendríamos una probabilidad de 0,41 sobre 1 de que haya de 1. cuando nos vamos al caso de que sean hombres aquí tendríamos un 0,21 de posibilidades de que sea 1 aquí tendríamos un 0,18 pero si le vamos aquí tendríamos por ejemplo un 0,67 nos están diciendo el segundo número indica cuál es la probabilidad de que sea un 1 y luego el número de abajo básicamente el número de arriba hemos dicho si hay más ceros o más unos El número del medio es básicamente cuál es la probabilidad de que haya unos en ese conjunto que estamos analizando. Y el número de abajo es cuál es el porcentaje del total de la muestra. Es decir, aquí es fácil porque 63 más 37 hacen el 100%, pero ¿por qué este 60 y este 3 no hacen el 100%? Porque es sobre el total de la muestra. Esto es muy importante. Es decir, este es un 60% y un 3%, no sobre este 63 entre comillas para que me entendáis, pero es el 60 del 100% del total de la muestra, el 3% del total de la muestra, el 2% del total de la muestra, el 1% del total de la muestra, del total de la muestra siempre. Es evidente de todas formas que este número más este número siempre me dará el número que tenga arriba, ¿vale? Porque al final lo que estamos haciendo es descomponerlo, ¿de acuerdo? Pero son números sobre el total de la muestra, ¿vale? Es decir que no es que por ejemplo parta de cero y si aquí tengo por ejemplo aquí tengo 50 casos, ¿vale? este 60% no son sobre estos 50 casos es sobre los 714 casos que tenían un inicio ¿de acuerdo? ¿se entiende? ¿más o menos? o no se entiende mucho aunque tengo una duda es que en la actividad dice que lo expliquemos y yo digo ¿qué tan largo sería la explicación que habría que darle a un árbol como este? Vale, para mi gusto lo que tenéis que decir primero es, ¿por dónde estáis descomponiendo? O sea, primero poner la imagen, la imagen tal cual os ponga, ponerla, ¿vale? Donde tengáis que hacerlo. Y luego aquí lo que yo diría es, en primer lugar, el árbol de decisión lo que hace es descomponer sobre si el sexo es hombre, ¿vale? O no. En el caso de que el sexo sea que es hombre, ¿vale? Tenemos que la casuística tiene la mayor parte de los casos no han sobrevivido porque el primer valor es un 0 entonces lo que tengo más abundancia es en este caso que no han sobrevivido la probabilidad en este caso sería ir narrando un poco todo, la probabilidad de tener un 1 sería 0,21 y corresponde al 63% de la muestra en los casos en los que son hombre, a su vez vosotros tenéis que la edad, una vez que tenemos definido que sea hombre, la edad lo siguiente que tiene el algoritmo en cuenta de si la edad es mayor o menor que 6,5 años. En el caso de que sea mayor o igual de 6,5 años, pues la mayoría o de manera general no han sobrevivido, la probabilidad de sobrevivir sería 0,18 y tendríamos que sustituir el 60% de la población que partíamos al inicio. Si el caso de que sea hombre y la edad sea menor que 6,5, pues tendríamos que lo más probable es que sobreviviesen con una probabilidad de supervivencia de 0,67 y un 3% de acuerdo de la población total. Tendréis que ir haciéndolo así cada una de las divisiones que tuvieseis. No sé si te ha ayudado. Sí, ahí te di una buena idea. Si os corrigiese yo me serviría con que me pusieseis esto y me dijeseis Dijéis que el 0 significa esto, el 0,41 esto y el 100% esto, ¿vale? Pero como no os corrijo yo, probablemente sí que tengáis que narrarlo un poquito. Aquí sí que tendréis que estar un poquito más de tiempo, ¿vale? Vale, entonces, una vez que tengamos hecho esto, ¿de acuerdo? Vosotros podéis hacer más cosas, ¿de acuerdo? Podemos, bueno, podéis igualmente tener pues varias... Los ceros, si uno solo se refiere a hombre o mujer, ojo, cuidado los ceros. y los unos en principio se refieren a la variable que tú estás prediciendo. Nosotros no estamos prediciendo en este caso hombre y mujer, estamos prediciendo que sobreviven o que no sobreviven. Entonces, el hombre y mujer lo tienes aquí. Y entonces aquí tú sabes que cuando tú vas a esta parte, todo este parte de aquí, tus datos en este caso todos serán hombres. Sí, ahora vuelvo a comentarlo. Y todo este caso aquí, todo, será respectivo a las mujeres. Pero este 0 y este 1 que tienes en todos los casos, son de la variable que tú quieres predecir, que es sobreviven o no sobreviven. ¿Sí? ¿Queda claro, Víctor? Aunque es cierto que en determinadas ocasiones tú irás fragmentando y segmentando, pero esos 0 y esos 1 es de la variable que predices. ¿Qué significaban los números de arriba del porcentaje? Sin problema. Primero, el primer número que siempre es 0 y 1. ¿Por qué? Porque estáis prediciendo si sobrevive o no sobrevive y los valores son 0 y 1. Entonces, el primer número lo que te dicen es qué hay más de la variable que tú estás prediciendo. en este caso, al principio ya habíamos visto que había 429 casos que no sobrevivían y 219, si no recuerdo mal o por ahí, que sí que lo hacían, que tenían un 1 entonces, ¿qué es lo que hay más? Personas que no sobreviven así que lo que se te ponen es el 0, porque lo que tienes más en ese grupo es el 0 cuando hacemos la primera división de sexo hombre o sexo mujer lo que tienes más en este caso es un 0 si te vas al caso de los hombres porque volvés a tener que hay más hombres que no sobreviven en este caso que que sobreviven por lo tanto vuelves a tener más el 0 sin embargo si te vas al caso de las mujeres tienes el 1 ¿por qué? porque en ese caso el mayor dato o hay muchas más casos de 1 que de 0 cuando lo descompones ese sería el primer valor, ¿el primer valor te queda claro Francis? y siempre es lo mismo, siempre es respectivo a la variable que tú predices. Predicimos una variable de ceros y unos, por lo tanto, siempre es cuánto más hay de la variable que tú predices. El segundo valor es la probabilidad de que tengas un 1. Es decir, en el primer caso teníamos que era 0, o sea que la mayoría eran 0, pero claro, hay una probabilidad de sobrevivir, hay una probabilidad del 1. ¿Cuál es la probabilidad? El 0,41. Si nos vamos al caso de que seamos hombres, la probabilidad de tener una supervivencia es del 0,21, pero esta es la probabilidad de tener el 1. ¿Sí? ¿Queda claro, Francis? Bueno, te lo digo a ti porque lo has preguntado, pero si alguien tiene alguna duda, me lo puede comentar sin problema. Y el tercero es, del total de toda la población antes de hacer cualquier tipo de división, ¿cuál es el porcentaje que corresponde a cada uno de los grupos? Lo digo tal que así porque si nosotros aquí teníamos 714 o 100, vamos a poner 100, aquí teníamos 100. Y aquí cuando lo hemos descompuesto, por ejemplo, se me quedan 50. Sé que no corresponde a este porcentaje, pero para que lo entendamos. Si aquí yo tengo un 60%, no es el 60% de 50, es el 60% de los 100 que tenía antes. ¿Se entiende? Lo mismo aquí, aquí tengo un 63. Este 63% quiere decir que de toda la población que tenía un origen, de esos 714 casos que tenían un origen, el 63% están en esta caja. Y de esos 714 casos que tienen origen, el 60% de ellos está ahí abajo. No es el 60% del nodo de arriba, de la cajita de arriba. Es el 60% del total de la población que teníais al inicio. Quiero que quede esto súper, súper claro. ¿Queda claro? ¿Hay alguna duda respecto a esto? Vale, quiero que quede claro porque a veces Si no me vais a decir, es que aquí hay un 63 Y aquí me hace, porque vais a decir 63 más 37 igual a 100 ¿Vale? Y luego os va a llegar aquí Y vais a decir 60 más 3, vais a decir No me da 100, ¿por qué no me da 100? Porque aquí lo que te dará 100 es el 60 Más el 3, más el 2, más el 1 Más el 9, más el 2, más el 22 ¿Vale? Pero no te dará lo anterior vale, perfecto bueno, pues esto respecto al árbol de clasificación, sé que me retraso un poquito más, pero quiero que veáis que es exactamente igual para que podáis hacer la actividad sin problemas estas navidades y con total tranquilidad cuando tengáis un momento podáis hacerlo, ¿vale? entonces, ¿qué nos queda por ver? nos queda por ver cómo hacer una predicción y nos queda por ver cómo hacer las matrices de confusión, ¿vale? para poder responder a esta parte de aquí que dice cómo podemos obtener una clasificación con una mayor precisión. Vale, pues esto es exactamente lo mismo que hemos hecho en la matriz con la regresión logística. Exactamente lo mismo y si utilizáis como debería ser el TAME y el TEST que lo tenéis que hacer para la entrega, ¿De acuerdo? Pues es exactamente lo mismo. Entonces voy a volver a ir a donde lo copiaba para que veáis que es exactamente lo mismo y que no hay ni trampa ni cartón. Es lo mismo en ambos casos. Vamos a seleccionar esta variable que es lo que habíamos hecho aquí. La voy a poner aquí. Y en este caso, en vez de ser la regresión logística, será el modelo de árbol. Vosotros ponéis el modelo de árbol. Veréis que... veréis que en este caso la única cambio es que igual que aquí hemos puesto class, aquí tenemos que poner class, pues hacemos esto así y aquí me da ya la predicción del modelo, la predicción del modelo con el random forest haciendo el método class ya me da directamente ceros y unos, no tengo que hacer el redondeo que hacíamos con la regresión logística, Y la matriz de confusión, por tanto, más de lo mismo, exactamente igual que aquí. Vamos a seleccionar esto, para que lo veáis. Seleccionamos esto, en este caso tenemos la predicción del modelo. y volvemos a tener la matriz de confusión que se analiza igual para la pregunta número 3 tenéis que hacer las dos matrices de confusión con el test por favor, con el 3, con entrenamiento y testeo como hemos hecho las semanas anteriores y aquí tendríamos el accuracy, el 0,81625 da un accuracy en este caso mayor que la regresión logística por tanto el mejor modelo sería el modelo del árbol, aparte de porque tiene mejor cobertura, el modelo de árbol es mejor en cuanto a los outliers y el modelo de árbol también es más fácil de interpretar, por lo tanto también lo solemos preferir por este motivo. ¿vale? Predicciones exactamente igual que hemos hecho para la regresión logística, ¿vale? Si es con nuevos datos. Voy a poner el caso, en este caso, de Leonardo DiCaprio, pero para que veáis que es exactamente lo mismo. Lo que pasa es que voy a poner la predicción del modelo de árbol, perdón, el modelo de árbol que lo tengo aquí, modelo de árbol, y los datos tienen que ser los mismos, pero aquí le voy a cambiar a que es de tipo clase. copiamos, lo pego, lo miro y aquí ya me dará en este caso la probabilidad sí que es cierto que en este caso vamos a tener mejor quitar el type class aquí al final para que nos dé solo un dato y no tengáis como los dos raros entonces hacemos así y ya me va a dar cuál es su probabilidad de que no sobreviva y cuál es la probabilidad de que sobreviva que en este caso la de que no sobreviviese da 0,82 con este modelo en vez de con el anterior que prácticamente era casi a 0,9 el caso del 0 ¿se ha entendido hasta aquí? más o menos Una consulta, entonces ¿Se hacen los dos modelos Y a partir de eso, calculándolo Mediante la comparativa de la cura Si vemos cuál es el más preciso, entiendo, ¿no? Exactamente, sí Sí, sí, sí, vosotros miráis la cura Sí, porque os lo preguntan por la cura Sí, podéis decir, por ejemplo También podéis comparar las Para poner más Más información, ¿vale? Podéis, si queréis, empezar a decir Pues, mira, es que esta matriz de confusión ha acertado en la predicción del 0 371 veces y 212 veces en la predicción del 1. Y resulta que el anterior a lo mejor me predecía, me lo invento, me predecía mejor los ceros porque a lo mejor me salía que ceros me predecía 400 correctos y sin embargo el 1 me lo predecía menor. También lo podéis hacer con los valores que habíamos visto de la matriz de confusión, ¿vale? Pero normalmente se decanta por el acurací. O sea, la pregunta es, ¿cuál de los modelos tiene mejor precisión? Es aquel que la cura si es mejor. Pero si queréis, para que quede más claro y no tengáis problemas, comentar más cosas acerca de la matriz de confusión podéis sin ningún tipo de problema, ¿vale? ¿Alguna duda respecto a este tema? ¿Alguna cuestión? pregunta por si acaso, me imagino que sí pero bueno, el 8 de enero igualmente bueno y antes del 8 de enero creo que tenemos clase, pero bueno igualmente el 8 de enero me toca dar una clase conjunta con todos los grupos y os explicaré de nuevo todo esto paso por paso, pero sí que ya será ejercicios tipo, tipo examen o ejercicios tipo entregas más que nada, o sea que ya ir un poco más directo, aunque realmente tendré que acoplarme también al nivel que tengan los otros grupos, vosotros sí que sé más o menos el nivel que tenéis, pero tendré que ver también el resto de niveles de todos los compañeros así que pregunta ¿queréis que aparte de esto en el documento que os suba os muestre otra forma de hacer el testeo y el entrenamiento? en clase hemos visto una forma, que es con el split de los índices y todo el tema del split de los índices. Pero por si acaso a alguien le da error hacerlo de esa forma, ¿queréis que en lo que os suba os ponga aparte otra forma de hacerlo para que cualquier persona, si lo probáis de una forma y no os sale, lo tengáis de una forma y si lo probáis de otra forma y no os sale, tengáis otras opciones para hacerlo de cara a la entrega? Vale. Vale. Veis que yo muchas veces os intento dar muchas formas de hacer lo mismo, ¿vale? Pero porque al final, ¿cómo explicarlo? Al final en programación hay muchas formas de hacer lo mismo y a cada uno de vosotros escogeréis la versión que mejor os convenga, que menos errores os da por naturaleza o la que más cómodos os sintáis haciéndolo, ¿vale? Entonces sí que es cierto que yo tiendo a daros un montón de cosas que se hacen exactamente igual de distintas maneras para que vosotros escojáis cuál es la que mejor os conviene o cuál es la que os sentáis más cómodos, ¿vale? Así que os voy a subir otra opción para hacer el tema de los testeos, entrenamientos, etcétera, ¿de acuerdo? Para que tengáis no solo la opción que vimos en su día, sino que tengáis otra opción que es con una librería que se llama Catools, ¿vale? Para que lo podáis hacer. De igual forma, si alguien, por favor, a la hora de instalar los paquetes le da algún tipo de error, recordad que os pasé una página de Posit para que pudieses descargarlo que da menos errores incluso que en el RStudio original. ¿de acuerdo? ¿queréis que esto os lo ponga en el foro? pregunta, el enlace a esta página por si acaso alguien tiene algún problema a la hora de descargar el archivo vale, pues os lo pongo, ¿vale? entonces, por hoy esto es todo, ¿de acuerdo? sí que quería daros el tema de los árboles de decisión porque quiero que podáis empezar con ello cuanto antes la última parte que quedaría, que es así ya la dejamos para la semana del 8 de enero es la parte de cómo encontrar todo el tema de qué importancia tienen las variables, ¿verdad? Pero bueno, esto ya lo veremos conforme tengamos tiempo en ese po, ¿vale? Pero sí que es cierto que por hoy yo creo que más que suficiente y la entrega la podéis hacer la primera, segunda y tercera pregunta. La cuarta pregunta sí que tendremos que verla más juntos, ¿vale? Pero bueno, por mi parte, un placer como siempre. Os subiré o completaré un poquito con esto y os subiré ya el archivo completamente comentado como siempre a la parte de documentación ¿de acuerdo? y tomadlo como referencia para hacer la entrega ¿de acuerdo? Felices fiestas, feliz navidad descansad muchísimo que yo sé que R está siendo duro, es normal, es vuestro primer lenguaje de programación y al próximo año cuando vayáis con Python veréis que es muchísimo mejor ya puede seros la derecha de la asignatura así que a mí me gusta mucho más Python, es mucho más entendible ¿vale? Entonces cualquier cosa que necesitéis siempre al foro Y nos vemos la próxima, bueno, nos vemos ya a la vuelta de vacaciones, ¿de acuerdo? Adiós.
