El material que se utilizó en la clase anterior, ¿dónde estará colocado? En documentos, lo voy a subir a vosotros y que os lo puedo subir yo a otros compañeros, pues sí que se lo tendré que pasar a su profesora correspondiente. pero dentro de vuestro módulo ¿vale? dentro de aquí tenéis aquí vuestra parte de documentación ¿vale? y dentro de esta parte de documentación tendréis los archivos como aquí os subiré repaso 1 o con ese nombre ¿vale? y lo tendréis también disponible ¿sí? y la grabación ¿y la grabación dónde estará? vale, esto lo hablaré con coordinación del máster para que os puedan dar la grabación yo la tengo grabada, muy probablemente el tema será simplemente pasarosla pero bueno, me aseguraré de hablar con ella para que lo podamos tener porque esto fue, bueno, ha sido una cosa que hemos considerado que era útil que hiciésemos este repaso con todos los grupos a la vez para que más o menos todo el mundo tuviese las mismas nociones o estuviésemos todos en sintonía, ¿de acuerdo? Entonces hablaré con ellos, porque sí que sé que al no hacer una... Vale, quedan las grabaciones de la aula general. Vale, menos mal. Al no hacer como tal una clase propia vuestra, tendréis que entrar a otra parte, pero lo pregunto, ¿vale? Muchas gracias, muchas gracias por su generosidad. La clase estuvo muy buena. No, no, no, o sea, a mí me lo dijeron y yo encantada, o sea, quiero decir que... Le fue muy bien, muchas gracias. No, gracias, gracias. La idea de todas formas, parte de coordinación, o sea que querían más o menos, sois varios grupos, más o menos que hubiese una clase más de repaso de cómo se hacen todas las cosas. Sí que os adelanto que el examen no a ver teoría va a ser más bien un poco lo que hemos estado haciendo en cada una de las entregas y lo que estamos repasando ahora. Por eso la parte de repaso se ha centrado mucho en programación porque al final es lo que será el examen, ¿vale? Pero sí que se toque el examen, pues imaginemos, ¿eh? Nos podemos preguntar, ¿hay valores nulos? Pues ya me decís cómo queréis hacerlo con los valores nulos, pero tendréis las preguntas bastante, bastante detalladas, ¿vale? No se os va a pedir de repente hacer, no, hacerme una regresión, o bueno, hacerme una regresión lineal y se os olvida los valores nulos. Pues, por ejemplo, va a ser prácticamente imposible porque seguro que tenéis una pregunta que os pregunte por los valores nulos, ¿vale? pero va a ser casi todo de programación ¿de acuerdo? lo que pasa que el día que tengamos esa clase lo veremos que si no recuerdo más la semana que viene ¿vale? pero lo veremos vale y muchísimas gracias quería que fuese bastante claro y utilicé un consejo de uno de vosotros y al final lo suficientemente en cuarto que normalmente nosotros no trabajamos con ello pero sí que es cierto que creo que como comentó el compañero es cierto que lo entendéis bastante mejor aunque yo es lo de así vosotros simplemente tenéis que copiar y pegar esto como siempre hemos hecho y os funcionará exactamente igual, ¿de acuerdo? Es decir, que aunque lo veáis así, si vosotros hacéis esto y lo copiáis en un nuevo archivo un nuevo archivo R script esto os funcionará ¿vale? Si vais copiando todos y cada uno lo que pasa es que os lo he puesto en ese formato para que se entienda mejor Bueno, dicho esto penúltima clase o antepenúltima clase una de las dos, ¿vale? ¿qué nos toca hoy? nos toca un tema que es bastante interesante que es el tema del aprendizaje no supervisado ¿vale? entonces como al final se os va a examinar más por el código si me permitís empiezo por el código y luego os doy la teoría ¿sí? más que nada porque al final lo que os van a preguntar más bien es el código entonces quiero que el código quede perfectamente entendido a pesar de que yo intentaré dar el repaso la próxima semana para que tengáis todo y que todo el mundo esté exactamente en la misma línea, ¿vale? Entonces, lo primero para este ejercicio vamos a partir de un conjunto de datos que se llama el Iris Dataset. Es un conjunto de datos muy utilizado y ya os digo que en la vida real no son las cosas tan bonitas como en este conjunto de datos, ¿vale? Pero está muy bien y se entiende bastante bien el cómo podemos utilizar este conjunto de datos, ¿vale? Entonces, lo que vamos a ver ahora que es clasterización, ya nos alejamos del aprendizaje supervisado ya no estamos prediciendo algo de lo cual tenemos un histórico por ejemplo ya no predecimos un precio en base a ciertas columnas el valor del precio antiguamente ni predecimos por ejemplo no oís al perro es que hoy me está dando la tarde tremenda espero que nos escuche muy bien si no pues me asento 5 segundos y ya lo hago callar pero bueno el tema vale a este tema que teníamos entre nosotros. El dataset Iris, ¿vale? Estamos hablando del aprendizaje no supervisado. Es decir, ¿qué quiere decir aprendizaje no supervisado? Que no sabemos nada de lo que queremos encontrar. Por ejemplo, tenemos un conjunto de clientes, ¿vale? Y yo no sé ningún tipo de grupo entre ellos. A ver, nosotros podemos hacer grupos por edades o podemos hacer grupos por yo qué sé, por productos que hayan comprado. Pero, ¿qué tal si le decimos al ordenador, yo tengo todos estos clientes, agrúpamelos como quieras, ¿vale? Pero yo no le digo nada de este grupo 1, este grupo 2, este grupo 3, no le digo nada, es simplemente que el ordenador él mismo sea capaz de agrupar las cosas, ¿vale? Pues esto sería el clustering, ¿vale? Que es lo que vamos a hacer y está dentro de aprendizaje no supervisado porque nosotros no le damos ninguna información, ¿vale? Entonces, el dataset que vamos a utilizar es un dataset que se llama iris, igual que hicimos con el titanic aunque sí que es cierto que en el titanic tuvimos que instalar la librería titanic en este caso no tenemos que instalar nada porque ya está dentro de las fases de R, es normalmente con el que se emprende todo ese tema de clustering dicho eso, vamos a hacer que cargamos los datos de iris, vuelvo a repetir igual lo he repetido en la clase anterior no os preocupéis, de acuerdo en el examen son o archivos excel o archivos CSV, ¿vale? Y en el caso que yo recuerde no es, ¿vale? Pero en el caso de que fuese así, os diríamos exactamente cómo tenéis que cargarlos, ¿vale? Pero que yo recuerdo son archivos Excel y archivos CSV, ¿vale? Pero bueno, en este caso vamos a cargarlo así y como hemos visto anteriormente, podemos hacer un view de datos. Hacemos este view de datos y vemos que son, bueno, unos datos bastante sencillitos. Tenemos la longitud, se trata de flores, ¿vale? Entonces tenemos la longitud del sépalo, el ancho del sépalo, la longitud del pétalo, el ancho del pétalo y luego una clasificación con la que vamos a comparar. De normal, ¿vale? De normal nosotros esta clasificación no la conocemos. Y nosotros queremos que nos agrupen los datos como el ordenador quiera, pero yo no tengo esa columna. En este caso, ¿por qué tenemos esta columna? Porque estamos en un proceso de aprendizaje, ¿de acuerdo? Y lo que haremos es comparar ese resultado, efectivamente son flores, lo que haremos será comparar ese resultado, ¿de acuerdo? Con el resultado que me dé mi modelo, pero esta parte ya os digo que normalmente no la tenemos, ¿vale? O sea, no sabemos ninguna información extra, ¿de acuerdo? entonces una vez dicho esto vamos a nuestro conjunto de datos y como siempre os recomiendo el tema de hacer la dimensión en este caso son 150 filas y 5 columnas y el tema de hacer el str de datos de acuerdo que tendríamos las distintas y cada una de las distintas columnas en este caso son todas numéricas con decimales o numéricas en formato predefinido puede haber una mezcla y luego tenemos especies que era factor. Recordemos que factor es cuando tenemos texto, ¿vale? Es decir, en este caso tenemos cetosa, versicolor y si no recuerdo nada, manera química, efectivamente, ¿vale? Pero solo hay tres posibilidades. Entonces, factor lo que nos dice es una cadena, es una columna que es texto, pero no es texto random, sino que solo pueden ser tres nombres concretos de texto, ¿vale? En este caso, cetosa, versicolor y virgínica. Eso, bueno, se llama internamente, se llama levels, los tres posibilidades en este caso que tiene y aquí te dice cuántos hay pues en este caso solo hay tres y luego los levels serían setosa versicolor y virgínica dicho esto hemos hecho nuestro dio nuestra dimensión, nuestro string que tendríamos que hacer como siempre los valores nulos por favor no se os olvide esta parte aunque ya probablemente en el examen os digamos que tengáis que hacer valores nulos o algo así pero por favor no se os olvide entonces colsams y en este caso, bueno de hecho para que veáis que es lo mismo os lo voy a copiar y pegar literalmente de lo que hemos visto antes para que veáis que no hay ni carta, ni trampa ni cartón y que al final si lo hacéis lo hagáis con lo que lo hagáis lo vais a ver, ¿vale? nosotros vamos aquí a la parte de call sums y para que lo veáis copiamos para que veáis que funciona perfecto, copiamos pegamos y aquí en lugar en este caso ¿qué será? serán nuestros datos, entonces vamos a hacerlo ¿y qué me sale? me sale que no hay ningún valor nulo ¿por qué no hay ningún valor nulo? porque es una dataset ya preparado para aprender clasterización y está muy muy preparado, de todas formas subiese valores nulos y vosotros decís no, lo que quiero es eliminar estos valores nulos hay más formas, yo ya os comenté que a mí la que más me convence y la que me parece más fácil es hacer el neomit. ¿Que hay más formas? Hay más formas, pero la asignatura de neomit me parece la más sencilla y la más entendible de todas. Esto sería si hubiese nulos. Si no hay nulos y lo utilizáis, no pasa absolutamente nada, ¿vale? Pero bueno, no es necesario porque no habría nulos que sería este caso, ¿vale? Dicho esto, siguiente, podemos hacer el análisis descriptivo de los datos. Recordemos, podemos hacer el summary Y aquí tendremos, por ejemplo, la longitud mínima del sépalo es 4,3, el primer cuantil 5,1, mediana 5,8, media 5,843. A ver, la diferencia es muy pequeña, luego probablemente no haya valores anómalos. De hecho, en estos casos, la única que os diría que a lo mejor tiene un poco más de valores anómalos sería la longitud del pétalo por la diferencia, pero es una diferencia también un poco pequeña. Tendríamos tercer cuantil y tendríamos máximo. También es importante saber que en un principio teníamos 50 de setosa, 50 de versicolor y 50 de virgínica para este caso concreto que estamos haciendo. Repito que normalmente esta columna de especies es la que yo quiero encontrar. Entonces es lo que estamos buscando. Lo mismo que hemos hecho antes, podemos hacer el table de datos, en este caso de por ejemplo, species. Y me dará lo mismo. si hacemos aquí el run tendremos que hay 50, 50 y 50 de partida vamos a dibujarlos podemos dibujarlos con el plot de datos recordad que lo que os suba estará todo comentado o sea que no os preocupéis vamos a hacerle aquí zoom zoom zoom zoom aquí y básicamente cuando hacemos un plot de todo el dataset lo que hace es compararme todas las columnas con todas las columnas por ejemplo aquí tendríamos el sepal length sería esta fila, ¿vale? Y este sería el sepal length en base a el ancho del sepal oval, es decir, este sería el sepal length aquí y esta columna es el ancho. Aquí sería sepal length en base a qué? A petal length, porque esta columna es petal length. Aquí tendríamos el sepal length en base a qué? Al petal width. Aquí ya podemos ver algunas casuísticas, ¿vale? Que lo podemos hacer también con la matriz de correlación, pero aquí ya se ve, fijaros. Entre la longitud del pétalo y el exo del pétalo se ve claramente que es ascendente y bastante ascendente entonces aquí estaríamos hablando por ejemplo de una correlación fuerte positiva lo más probable, sin embargo si nos vamos por ejemplo al sepal width con el petal length pues la verdad no encuentro ningún tipo de relación, hay como dos grupitos pero no sabría decir si es ascendente o si es descendente lo mismo me pasa un poco pues en este caso con species pero básicamente es porque es de tipo texto entonces tampoco tiene mucho sentido, la verdad. Pero bueno, aquí es el tema. No entendí cómo se lee todo esto. Vale, no pasa nada. Fíjate, tú tienes filas y tienes columnas y es simétrico. Es decir, tú tienes el sepalens tienes el sepalens y este sepalens que te marca, te marca esta fila, esta fila es sepalens y toda esta columna sepalens también. Por eso, cuando es el sepalens con el sepalnet no te puede hacer una representación porque estarías haciendo una representación de él consigo mismo, ¿vale? Si vamos aquí al sepalwith te está diciendo que esta fila es sepalwith y esta columna es sepalwith. Por lo tanto cuando nosotros tenemos este gráfico ¿qué está haciendo? Está haciendo fila sepalnet columna sepalwith ¿de acuerdo? Si te das cuenta este gráfico es muy parecido a Teod ¿por qué? Porque es el mismo simplemente dado la vuelta, porque aquí estás haciendo el sepal width respecto del sepal length no os vamos a tener que analizar esto, tranquilos, pero bueno en caso de que para que lo sepáis en el examen no os haremos analizar esto, pero bueno es una forma también de entenderlo, entonces aquí por ejemplo lo que es claro es que la longitud del pétalo y el ancho del pétalo parece que está bastante relacionado con una correlación probablemente fuerte positiva que podríamos calcular si queréis, lo que pasa es que vamos directos a hacer la clasificación ¿qué ocurre? que tenemos una variable que es de tipo texto podemos simplemente decirle yo quiero todos mis datos exceptuando la variable, este mismo dibujo pero quitándome la última variable que es la variable de tipo texto porque puedo considerar que no me da mucha información podemos hacerlo tal como lo hemos hecho con el library de plier como hemos visto hoy, como solemos hacer y hacer un plot de datos, porcentaje, mayor porcentaje, select y quitamos la columna de species, podríamos hacerlo así, la otra opción que también a lo mejor a alguien le interesa es decir, vamos a mi columna de datos, bueno, aquí me sirve, tengo la primera columna es length, la segunda columna es width, la tercera columna es length, petal length, la cuarta columna es petal width y la quinta columna es species, ¿vale? Entonces yo puedo decir que quiero todos mis datos, ¿vale? Exceptuando o solo teniendo los datos numéricos. Yo personalmente creo que es mucho más sencillo que hagáis incluso, incluso, ¿eh? Hacer un datos numéricos, datos dólar, perdón, porcentaje, mayor porcentaje. el select where is.numeric para que no es que me lo invento ¿de acuerdo? tenéis aquí donde hacemos la correlación que esto os subiré todo, de hecho os lo subiré para que lo podáis tener pero es lo mismo que hemos hecho aquí, ¿vale? si os dais cuenta el select where is numeric es lo mismo, ¿vale? entonces con esto nos quedamos ya directamente con todas las columnas que son numéricas y luego de datos no y nos sale con todas las que son numéricas otra forma de hacerlo hemos dicho que la columna 5 es la que tendríamos que quitar sería plot datos ¿de acuerdo? y seleccionamos con los corchetes, tenemos a decir quiero todas las filas, por lo tanto antes de la coma no ponemos nada porque quiero todas las filas hasta la columna 5, entonces le ponemos un menos 5, aceptando la columna 5 y si hacemos esto nos dará exactamente lo mismo, ya decidís vosotros si preferís esta forma o preferís esta forma, ambas opciones son correctas o podéis preferir la de la del select, menos y la columna species, las tres formas son idénticas la que más cómoda os sintáis vale lo que habíamos visto, podemos hacer core de datos si yo lo hago core de todo mi conjunto de dataset, de todo conjunto de datos ¿qué ocurre? me sale un error recordemos que la correlación y la covalianza, ¿se oye mucho al perro? no, ¿verdad? entiendo que no, bueno si se oye en algún momento, mandadme no tengáis miedo a ponérmelo por mensaje, ¿vale? ya me desapaño, pero si en algún momento se oye, espero que no, pero si se oye menos mal, porque se está desgañitando en este lado, digo a ver si se está escuchando y se escuchaba la clase. Lo que os comentaba, la correlación de datos. Vale, muchas gracias. La correlación, ¿vale? En este caso, vamos a hacer la correlación de todo el dataset. ¿Y qué ocurre cuando hacemos la correlación de todo el dataset? Ocurre lo siguiente. Ocurre que nos dice, X debe ser numérico. ¿Por qué? Porque tenemos todas las columnas incluidas las columnas que son de tipo texto. Y esto no debe pasar. La correlación y la coberianza no podéis hacer columnas de tipo texto. es por ello que yo aquí os lo ponía de esta manera ¿vale? de esta forma seleccionando las que son numéricas, entonces vosotros podéis hacer, perdonad que esto es lo que luego os quiero enseñar vosotros podéis hacer bien core de datos num ¿vale? que os saldrá la correlación ahora la analizamos o bien podéis hacer perfectamente si queréis el datos num porcentaje mayor porcentaje porcentaje, un momento porcentaje mayor porcentaje y hacer aquí la correlación, ¿vale? es exactamente lo mismo, es igual en este caso, ¿por qué no ponemos lo que aquí hemos puesto de complete observations, que lo tenía por aquí, porque en este caso ya hemos visto que no hay valores nulos y si lo sabía los hemos omitido, ¿vale? pero si, si estáis acostumbrados porque os acostumbráis a hacerlo de una cierta forma y os acostumbráis a poner esto bien también, aunque no haya valores nulos simplemente lo ponéis como salvaguarda por si acaso os equivocáis o no os habéis eliminado al principio si os dais cuenta el resultado es lo mismo y aquí podríamos mirar un poco lo que ya habíamos visto con las gráficas si vamos al Petal Lens y el Petal Width fijaros, la correlación es prácticamente 0,96 es prácticamente 1 lo que vendría siendo, que os comentaba no, es que en estas dos se ve claramente la recta ascendente entre el pétalo en y el pétalo en y esto se nos ha visto en la correlación de la misma manera pues tenemos por ejemplo que el pétalo en, la longitud, perdón, el ancho del pétalo respecto al ancho del sépalo fijaros que es negativo es decir, cuanto más ancho sea el pétalo, más delgado o menos ancho sería el ancho del sépalo, ¿vale? Y lo mismo viceversa, ¿vale? Importante, de todas formas, si os preguntan covarianza y correlación, aseguraros de que estéis analizando las dos. Recordemos, covarianza, sobre todo miramos símbolo, signo, perdón, signo, si es positivo, si es negativo. Correlación es cuando ya podemos decir si es correlación fuerte, correlación débil, correlación... Y en base a este número, tendríamos que especificar el número como tal, ¿vale? ¿Desde aquí todo bien? De momento, pues esto también es un poco repetido. Ahora ya vamos a los clusters, ¿vale? Profe. Vamos, dime. Claro, dime. Lo que tú mencionas es que con la misma matriz de correlación, entonces analizamos tanto correlación como covarianza. Efectivamente, o sea, a ver, al final una cosa es lo que os pidamos en los exámenes y que tengáis que demostrar que sabéis las dos cosas, ¿vale? Y otra cosa es la vida real. En la vida real, con la correlación, ya tenéis el signo de la covarianza, ¿vale? Y ya tenéis el valor si es fuerte o débil porque lo podéis hacer en base al menos uno y uno, ¿vale? Entonces normalmente lo que se intenta mirar sobre todo es la correlación, ¿vale? sí que es cierto que si en el examen nos preguntamos covarianza, que la podemos hacer también, no hay ningún tipo de problema si hacemos la covarianza, aquí para mí es mucho más, sobre todo lo que hay que interpretar es el signo si es positivo o si es negativo, podéis decir la longitud del pétalo con la longitud del sépalo pues tiene una covarianza mayor que la longitud del pétalo o el ancho del pétalo con el ancho del sépalo lo podéis decir, pero de la covarianza sobre todo es si es positivo o si es negativo Ahora, para saber la fuerza de cómo de fuerte es esa relación, se utiliza siempre la correlación. En el examen se os pregunta para las dos cosas, tenéis que analizar las dos cosas. En la vida real, con que hagáis la correlación os sirve, porque la correlación, entre comillas, ya muestra un poco lo que sería la covarianza también. Sí, sí, mucho bien. Sí, así es otro sitio pondríamos el LM cuando era regresión lineal, el GLM cuando era regresión logística y el RPART cuando estábamos hablando de un árbol ¿vale? en este caso Scamins ¿de acuerdo? tenemos que especificarle los datos y cuántos números o sea cuántos grupos queremos que haga ¿vale? recordad la clasterización que es lo que estamos dando ahora lo que hace es agrupar los datos según los parecidos que los vea el ordenador Es decir, yo no tengo por qué entender esta agrupación, ¿vale? Pero los agrupa como le vengan ganas al ordenador, sus motivos tendrá, ¿vale? Entonces, en un primer momento yo puedo decir, bueno, pues tengo mi conjunto de datos, por favor, datos numéricos, recordemos que no le vamos a dar la solución de las especies. Y quiero hacer dos grupos, ¿vale? Bueno, pues nosotros hacemos esto, el camins, ¿vale? Esto es todo el resultado que nos da. y aquí lo que nos dice es que tenemos dos clusters, dos clusters, el primero con 53 valores, 53 puntitos y el segundo con 97 puntitos, ¿vale? Nos da aquí el vector, es decir, fijaros, la fila 1 ha dicho que pertenece al grupo 1, la fila 2 ha dicho que pertenece al grupo 1, la fila 70 nos ha dicho que pertenece al grupo 2 entonces nos está clasificando no quiero decir clasificando, agrupando los datos en dos clústeres diferentes más cosas que hay que tener en cuenta de aquí esto de aquí es muy importante fijaros, si nos vamos al clúster 1 la longitud del sépalo es 5 es menor que la longitud 2 el clúster se lee de arriba a abajo fila, grupo, fila, grupo y así vale, no sé si te estoy entendiendo muy bien sí, o sea, esto esto de aquí es primera que tienes es la fila que tú estás la fila de los datos que le has dado tú le has dado unos datos, entonces sería la fila perfecto, era esto y lo de abajo efectivamente es el grupo al que lo asigna Vale, sí, sí, sí, sí, efectivamente lo que has comentado, ¿vale? Entonces, fijaros, vamos a poner el grupo 1. Yo que veo a simple vista, veo que la longitud del sépalo es mayor en el grupo 2 que en el grupo 1. El ancho del sépalo es menor en el grupo 2 que en el grupo 1. La longitud del pétalo es mucho mayor en el grupo 2 que en el grupo 1. Y el ancho del pétalo es mucho mayor en el grupo 2 que en el grupo 1. entonces, quitando por el ancho del sépalo yo lo que podría decir es el grupo 1 son flores pequeñas el grupo 2 son flores grandes ¿sí? ¿por qué? porque no es solo que el algoritmo nos dé unos resultados tenemos que saber interpretarlo entonces yo de estas cosas lo que puedo interpretar es que el grupo 1 es flores pequeñas y el grupo 2 son flores grandes ¿sí? pero ahora nos preguntamos ¿y por qué hemos hecho dos grupos? ¿Y por qué no hacemos tres grupos o cuatro grupos o cinco grupos? Lo podemos hacer. Vale, voy para allá, voy para allá. A ver, aquí. Podemos en lugar de dos poner aquí un tres. Vale, pues tenemos aquí un tres. En este caso tenemos tres grupos, uno con 33 flores, otro con 96 y otro con 21. si miramos ahora las medias de los clastes tendríamos que el primer grupo vemos que es como intermedio, es como la posición intermedia luego si miramos el ancho del sépalo vemos que el mayor es el grupo 1 si miramos la longitud del pétalo el mayor sería el grupo 2 y los otros dos están más o menos iguales Y si miramos el ancho del pétalo, vemos que el grupo 2 también es el que parece que tiene muchísimo más, ¿vale? Entonces, ¿qué a lo mejor nos estamos pensando? Pues a lo mejor decimos que el grupo 1, como tiene el sépalo... Bueno, ¿sabéis lo que es un sépalo y el pétalo, no? A lo mejor estoy hablando aquí. Os pongo una foto y lo miramos, ¿vale? Me tocó gustarlo, profe. yo no sabía, es la hoja que está abajito de la, pues del pétalo exactamente vamos a poner sépalo y pétalo para que lo veáis todos, pero claro en el examen no os cae algo tan usado, es decir si os cae algo, es algo que sepáis interpretar sin necesidad de mirarlo pero claro, en mi caso como sí que estudié bastante biología también pues he pensado sépalo y pétalo y ya estoy en plan de sépalo y pétalo y no siempre se estudia en todos sitios, entonces aquí se ve bastante bien bueno, no, aquí no tienes el sépalo vale voy a ver una que ponga bien claro que es el sépalo y el pétalo vale, aquí vale, vemos que el sépalo es como cuando la flor antes de estar la flor como tal tenéis el capullo, el capullo se va abriendo pues eso sería el sépalo esas hojas, el nombre específico, y luego el pétalo pues el pétalo, efectivamente, como los bracitos entonces nosotros partiendo ahora de esto pues tenemos aquí unas longitudes yo por ejemplo podría decir el clúster 1 agrupa aquellos que la longitud del sépalo pues es intermedia el ancho del sépalo es mayor por lo tanto podemos considerar que a pesar de que la longitud sea intermedia pero son como más robustos porque es como más grueso pues como más robusto sin embargo son flores pequeñitas podemos estar hablando a lo mejor son que la flor todavía no está floreada sino que simplemente es el capullo de la flor y ya está, ¿vale? El caso 2 serían aquellos que el sépalo es el más grande por lo tanto probablemente sean flores que florezcan como muchísimo más, ¿de acuerdo? El ancho del sépalo no es tan grueso como el caso 1 y luego en cuanto a los pétalos pues sí que es cierto que son los más grandes tanto en longitud como en ancho por lo tanto podemos estar hablando de que pueden ser flores más grandes como por ejemplo lirios que son la flor bastante bastante grande y cuando nos vamos al clúster 3 si vemos la media tenemos que en cuanto al sépalo pues sería un poco el más pequeño de todos es decir, tiene como la parte que lo sujeta pues lo más pequeñito pero luego en cuanto a longitud y ancho pues también son muy pequeñas, estaríamos hablando estas sí que serían como flores muy muy pequeñitas se entiende un poco como podemos analizar las medias de los clústers porque esta parte es importante ¿Sí, no? Sí, profe, sí Y finalmente pues le escuché la otra vez en la otra clase que lo que uno busca es un equilibrio ¿Sí? El equilibrio entre los clúster según lo que veo ahí eso estaría muy desequilibrado ¿No? Efectivamente, sí, ¿vale? Por ahí tendríamos 33, 96 y 21 que oye, que se pueden dar casos se pueden dar casos de que de que cuando aunque tú hayas partido de que tú sabes una clasificación que es 50, 50, 50, que es lo que nosotros hemos partido y que de normal no tendréis, ¿vale? Pero en este caso que es clúster y no es regresión logística, ahora explico la regresión logística en este caso que puede ocurrir que cuando el ordenador analiza todas las características de las flores te diga, oye no, pues no son tres grupos sino que son dos o no son tres grupos tan heterogéneos porque a lo mejor tú lo has clasificado en base al color y él te lo está clasificando, por ejemplo en base a otras características, ¿vale? Esto no quiere decir que cuando nosotros hacemos clasificación que es diferente, ¿vale? que es cuando nosotros sí que sabemos de partida los grupos es decir, aquí tú dices agrúpamelos como quieras pero quiero tres grupos, ¿vale? Y cuando hablamos de clasificación que es cuando hacíamos la regresión logística y cuando hacíamos el árbol de decisión, lo que le decimos es, oye, yo sé que dentro de mis clientes tengo el grupo de los clientes internacionales, el grupo de los clientes nacionales y dentro del grupo de los clientes nacionales, además lo divido en un grupo mayor de 40 años y menor de 40 años. Pero yo ya sé esos grupos. Entonces el algoritmo ya me va a clasificar en esos grupos que yo sé de antemano. ¿Sí? ¿Se entiende? son dos cosas distintas, ahora mismo es agrúpamelos como quieras acá es diferente claro, porque aquí es agrúpamelos como quieras porque normalmente normalmente no tenéis esta columna es el que define de alguna manera los grupos exacto, exactamente no tiene que coincidirte con esto de especies, ¿vale? sin embargo, si tú hicieses una recesión logística, bueno, una clasificación, ya sea una recesión logística ya sea un árbol de decisión ¿vale? Entonces sí que tendrías en cuenta esta columna y sí que sólo podrían ser esos tres grupos, Cetosa, Versicolor siempre los nombres son muy similes Versicolor y Virgínica, ¿vale? Porque hablaríamos de una clasificación y clasificas en estos grupos, pero ahora no estamos haciendo eso ahora estamos diciendo, te doy todos los datos numéricos y agrupamelos como quieras da igual como me lo hagas yo quiero dos grupos o yo quiero tres grupos y en el ordenador es el que va a estar voy a hacer esto, voy a hacer esto, voy a hacer esto ¿se entiende? o sea que uno podría profe utilizar los dos modelos para hacer un contraste por ejemplo de hipótesis ¿sí? donde podría iniciar partiendo de lo que conozco lo que supuestamente conozco y después lo hago que el sistema me lo haga digamos a la manera como el piensa después los contrasto y veo que tan cierto es lo que yo estoy diciendo comparado con lo que el primer lo pone Exactamente de todas formas para eso necesitas la columna especies que normalmente cuando hacemos clasificación estas clasificaciones aparte no las tenemos pero justo lo que has dicho tú lo vamos a utilizar al final porque lo que haremos será comparar el resultado que me ha dado de mi agrupación con el resultado que me daría un árbol de decisión o sea que te me has adelantado pero en efecto sería así pero son dos cosas distintas así que quiero que quede esto claro porque cuando tenemos las clases de antemano y solo clasificamos en esas clases estamos ante aprendizaje supervisado y en el que tenemos que hacer descomponer entrenamiento, testeo, etc. ¿Vale? Y clasificamos en estas clases, ¿vale? Regresión logística y árbol de decisión. Cuando hablamos de clasificación yo le digo al ordenador agrúpamelo como te dé la gana. Solo quiero dos grupos, te las apañas como puedas, ¿vale? Y aquí estamos en aprendizaje no supervisado, ¿de acuerdo? Y no hay que hacer ningún tipo de entrenamiento ni testeo ni nada. ¿Sí? Quiero que quede bastante claro porque a veces se lleva como a confusión porque las dos clasifica pero sí, muchas gracias profe, dime aquí el número que uno asigna, el número que se asigna, que tú estás haciéndolo ahí, digamos de manera determinística el sistema en algún momento me arroja un número que sea el adecuado vale, bien bien, es justo lo que te iba a explicar ahora, efectivamente creo que te he entendido, creo que te refieres a ¿por qué tres grupos y no cuatro grupos cinco grupos o seis grupos? sí, exacto para esto tenemos dos formas, ¿vale? dos métodos que son interesantes lo que pasa que me dejas voy a explicaros una cosita antes y luego os explico los dos métodos, ¿vale? que de hecho es de lo último que quiero enseñaros Entonces, vamos a guardar esta clasterización igual que hacíamos los modelos, ¿de acuerdo? Que hacíamos modelo y la fechita y luego el LM, pues lo mismo con la clasterización. Y de aquí vamos a ir al summary de clasterización. Bueno, lo que estamos viendo es básicamente lo que es la teoría, pero bueno, summary de clasterización, ¿de acuerdo? En este caso no nos da mucha información más que hay 150 clústeres aunque sean tres grupos pues sí que es cierto que ha habido como varias iteraciones entonces pues ha considerado 12 centros pero efectivamente la silueta y la inercia. En este caso, os da más las métricas entre lo que serían las métricas del intracluster y el intercluster. Pero en este caso no vamos a analizar esto. Si os preguntamos esto, lo que os preguntaremos más bien es que me digáis lo siguiente. Table de, por ejemplo, la clasterización. Bueno, primero clasterización. Dólar, si no recuerdo mal, clúster. Esto lo que nos dice, ¿vale? Es dónde ha clasificado cada una de las filas. Un poco lo mismo que habíamos visto en el resumen, pero aquí ya lo tenemos como en formato más bonito y lo podemos guardar como un vector, ¿vale? entonces nosotros ahora lo que podríamos decir es hazme una tabla de clasterización $cluster que vendría siendo lo mismo que hemos visto antes pero esto nos lo daría en formato tabla que en este caso el clúster 1 son 21 flores el clúster 2 33 y el clúster 3 96 podemos incluso compararlo que de aquí venía lo que comentabas en el caso de que tengamos como es en este caso una clasterización que lo acabamos de realizar clasterización barra claster y aparte tengamos los datos de una clasificación que nosotros conocemos datos dólar nuestros datos iniciales dólar y en este caso se llamaba especies yo puedo compararlos en una tabla y fijaros que me sale que cetosa la he clasificado 17 veces en el 1 33 veces en el 2 que versicolor cuatro veces en el 1 y tres veces en el 46 pero el clúster 3 sí o sí son las de virginica si os dais cuenta porque las 50 las ha clasificado en el clúster 3 ¿se entiende lo que hemos visto hasta ahora? sí no, la verdad que esto último me perdí dime ¿Había un sistema de clasificación para arrancar? ¿Había varios ítems? No sé, thoughts with things thoughts with things Esto, de momento, no se os va a preguntar ¿Vale? Aquí, sobre todo, para una persona que ya lleva bastantes años lo que te dice básicamente es que son 150 elementos los que has clasificado que durante todo el trayecto Bueno, para esto os voy a explicar antes lo que hace el camino Creo que tengo tiempo Dame 5 segundos lo enseño paint, paint, paint imaginemos el caso de paint, ¿vale? imaginemos que nosotros tenemos aquí uno, dos, tres bueno, voy a ponerlo un poquito más grueso porque si no, no vais a ver, tenemos un conjunto de puntos así, ¿vale? otro puntito es así y así, ¿vale? por ejemplo, evidentemente esto es un ejemplo para que lo veáis, ¿vale? ¿qué hace el Cummings? el Cummings parte de unos puntos que considero como centros, dices, vale, tú que eres tres grupos pues yo voy a considerar el centro esto va a ser algoritmo entre más o menos entre sí, lo puedes predefinir también a que sean los centros que tú quieras, ¿vale? pero definimos este otro centro más o menos aquí y este otro más o menos aquí entonces, ¿cómo funciona el K-means? el K-means lo que hace es lo siguiente dice, vale, vamos a coger este punto de aquí, ¿vale? y, ¿de acuerdo? ¿cuál es la distancia de este punto a este punto que yo he hecho el centro? ¿Cuál es la distancia de este punto a este punto que yo he hecho el centro? ¿Y cuál es la distancia de este punto? Sí, sí, os lo pasaré. Y también se la pasaré a la coordinadora para que se lo pase al resto de compañeros. ¿Cuál es este punto a este punto? Y lo que hace el Camins es que de las tres distancias se selecciona la menor. vale entonces dice vale pues la menor está con lo cual este punto de acuerdo este punto con este centro y ahora una vez que ha hecho este punto va con este centro y lo agrupa a ese clúster a ese clúster en este caso por ejemplo el clúster 1 que es el que de momento al principio sólo tiene un punto y ahora le hemos añadido el segundo aquí hace la media generalmente entre estos dos puntos y lo que hace es decir, vale, pues nuevo centro es este punto de aquí entonces cojo el segundo punto el punto de aquí, ¿vale? y hago la distancia a este centro a este centro y este centro y selecciono de nuevo la distancia que sea menor entre ellos, pongamos que están bastante parejas, pero pongamos que es a este, ¿vale? entonces lo que haría sería crear otro cluster, bueno, creas una agrupción y dice, va, el centro ahora lo considero en este medio y va repitiendo para todos los puntos, ¿vale? Entonces lo de los doce básicamente es el número de iteraciones, creo, si no recuerdo mal, pero nos lo van a preguntar. Esto de withins y dot withins es temas de métricas, ¿vale? Que tampoco vamos a entrar en esto. Entraremos probablemente el próximo el próximo cuatrimestre así que veremos pues la silhouette la inercia y veremos muchísimas más métricas para analizarlo pero en este cuatrimestre como tal que solo os ponéis pues sería esa parte vale entonces, bueno no sé si te he solucionado bueno y ahora repaso todo el resto vale, a partir de ahí repaso todo el resto vale entonces en la parte que dice table se puede interpretar que 17 setosas se utilizaban para el primer grupo, 33 para el segundo grupo y 0 para el tercero, efectivamente Entonces, lo importante es que nosotros tenemos nuestra clasterización. ¿De acuerdo? Omitice el summary. Para ser más exactos. Dime. Profe, no sé si está bien la conclusión. ¿Se podría decir que hizo 12 iteraciones para llegar a esos tres subgrupos? Os voy a poner esto. Sí, efectivamente, en principio sí. Pero si vosotros ponéis centros, podéis ver todos los centros que ha habido. ¿de acuerdo? que sería, si os dais cuenta, son 4 porque tienes el centro en cuanto a la columna de longitud en cuanto a la columna de ancho, en cuanto a la columna de pétalo de longitud y en cuanto a la columna de pétalo de ancho, ¿por qué ha hecho tantas iteraciones? porque piensa que la clasificación la tenéis que hacer en todas las columnas, cuando vosotros hacéis una agrupación, coge un centro vosotros no podéis representar gráficamente varias columnas en un mismo, o sea, por ejemplo, no podemos hacer gráficos de dimensión 4, de dimensión 5, de dimensión 6. Nosotros lo que podemos hacer son gráficos normalmente en dos dimensiones, ¿vale? Entonces, en este caso, para cada una de las columnas tienes tu propio gráfico en dos dimensiones donde vas seleccionando los centros que van para cada uno. Entonces, al final repites el proceso unas 12 veces. ¿Se entiende más o menos? Sí, aplicando, me imagino el centro de gravedad. No. No, el centro, o sea, lo que hace es el centro, normalmente tú puedes predisponer que sean los centros que tú quieras al inicio, o si no, él directamente selecciona unos centros, ¿vale? Y luego va calculando las distancias en base, normalmente distancia con métrica Euclidia, a menos que especifiques lo contrario, y lo que va haciendo es midiendo las distancias de cada punto, cada uno de los centros para esa columna concreta, y lo va haciendo así para todas las columnas, ¿vale? Por eso al final, o sea, no es exactamente así. Esto realmente son las coordenadas en un espacio de cuatro dimensiones, pero bueno, esto sería ya como para que lo entendáis, es como si lo hiciese para cada una de las columnas, ¿vale? Si alguien sabe más de matemáticas o quiere profundizar en este tema, lo que se hace son espacios de cuatro dimensiones en los cuales nosotros no lo podemos dibujar, pero el ordenador sí que puede trabajar. Entonces realmente esto serían como las coordenadas y nosotros representamos este punto en el espacio de los cuatro dimensiones para cada uno de los centros. y esta parte del centro son las coordenadas en cada una de las columnas de cada objeto, ¿vale? Pero para que lo entendamos es básicamente como que lo hagas para cada columna aparte, ¿vale? ¿Se entiende ahora mejor? No se lo van a preguntar los centros, me sorprendería mucho. En el examen juraría que no hay ningún tipo de pregunta respecto a los centros, ¿vale? Bueno, entonces nosotros tenemos la clasterización $cluster, ¿vale? Esto que es lo que nos hacía nos recupera cada una de las filas, es decir, la fila 1 la ha asignado al clúster 1, la fila 2 la ha asignado al clúster 1, la fila 67 la ha asignado al clúster 3 y la fila, por ejemplo, 132 la ha asignado al clúster 2. esto es lo mismo que veíamos si nosotros hacemos el camins de datos numéricos C si yo hago esto aquí fijaros que al final no es un vector de clustering pues es exactamente lo mismo lo que pasa que si lo hacemos de esta forma pues lo podemos utilizar fuera de todo ese concepto pero es lo mismo ¿vale? entonces esto no es más que todas las filas no es más que todas las filas en qué grupo las clasifico, ¿vale? Los números de arriba, las filas, los números de abajo, los grupos. Y podemos decir, bueno, ¿cuántos están en el grupo 1? ¿Cuántos están en el grupo 2? ¿Cuántos están en el grupo 3? Porque aquí nos comentan, oye, tienes tres clases, 38, 62, 50. Por cierto, no es determinista. Cuando ejecutéis, pueden cambiar los valores. Es decir, puede cambiar a dónde dirigen cada uno, ¿vale? Entonces, vosotros hacéis aquí el table, ¿vale? Y entonces veréis que en este caso, en esta segunda vez, en el grupo 1 son 50, en el grupo 2 son 38 flores y en el grupo 3 están 62 flores. Además, podemos decir, oye, yo sé, tengo una clasificación previa que normalmente no tenemos, pero en este caso tenemos, que era la clasificación previa de versicolor, de setos y de higiénica. y nosotros podemos querer decir, bueno, la que tengo es clasificación previa. ¿Cuántos datos son de versicolor? ¿Cuántos datos del clúster no son de versicolor? ¿Cuántos serían de virgínica y cuántos serían de cetosa? Por ejemplo, podemos preguntárnoslo. Entonces, lo que podemos hacer es una... Sí, exactamente. Muy bien, Gaby. Entonces, podemos hacer aquí una table en regresión lineal y regresión logística, así que hemos especificado la seed. vale, entonces aquí tenemos la table y aquí tendríamos 50, 2 y 14, vale, entonces en este caso fijaros que una vez que he vuelto a generarlo porque no hemos especificado la semilla una vez que he vuelto a a ejecutarlo, pues en este caso es el grupo 1 el que tiene esas 50 flores de cetosa, vale mientras que en los otros casos nos clasificaba mucho mejor por ejemplo el virgen, vale, si queremos que esto no nos pase, tenemos que hacer como bien ha comentado Gabriel y como por ejemplo hemos hecho en otros casos poner aquí una cosa que se llama el set.seed a ver donde lo puedo poner aquí, el set.seed ¿de acuerdo? y poner una semilla, por ejemplo bueno, el seed si no recuerdo mal y ponemos la semilla, que en este caso sería 0 ¿vale? pero bueno, esto lo podéis mirar que lo hemos visto en otras ocasiones ¿vale? importante, que no quiero irme sin deciros esto ¿de acuerdo? aquí ya tenemos la clasificación han sido este y tendríamos la tabla con cómo ha ido la clasificación pero no quiero irme sin comentaros cómo podemos decir si tienen que ser dos o tres grupos esto se hace mediante dos métodos en R existen dos métodos cuando tratemos con Python solo veremos el método pero en R existen dos métodos ¿vale? primer método, existe una librería concreta que se llama Facto Extra, si no recuerdo mal. Library Facto Extra. ¿Vale? Si veis que esta librería no la tenéis, ¿de acuerdo? O al instalarla os da problemas, recordad Posit, ¿vale? Descargarlo con ello que no vais a tener problema. Y dentro de esta librería existe una función que se llama FBiz, ¿vale? FBiz NB Plus. ¿De acuerdo? ¿Qué me va a decir? Lo que estamos esperando, ¿vale? por ejemplo datos numéricos y le digo aquí que quiero hacer con cárceles entonces cuando yo ejecuto esta que tiene nosotros que tengo que tener y el camin de acuerdo esperamos un poquito fijaros que me sale este gráfico y este gráfico me dice oye fíjate que el número que me recomiendan en este caso sería 2 es decir aunque nosotros partamos de que tenemos una clasificación de tres tipos de flores el algoritmo cuando los ha agrupado por semejanza dice no son tres, son dos ¿por qué? porque tenemos aquí esta línea discontinua entonces esta es una de las formas que podéis hacer ahora bien, si queréis hacerlo muchísimo mejor podéis hacer el método del codo ¿vale? con el método del codo es la misma función ¿vale? entonces pones aquí datos num camins y ahora he puesto un paréntesis de más, ¿de acuerdo? y dentro de este datos num y este camins ¿vale? vamos a añadir otra cosa más esta otra cosa más va a ser con qué método queremos que nos dé esta función fbiz nbclast si alguien sabe Python sabrá que el método que normalmente utilizamos es la inercia, que es un poco el error, ¿vale? en este caso también lo vamos a utilizar pero se llama WSS que viene de la palabra inglesa Within Cluster Sums es decir, la suma de los cuadrados de las distancias que hay entre cada uno de los clusters vosotros solo necesitáis saber que es WSSS ¿vale? y aquí ya os dará algo más parecido al método del codo ¿por qué se llama método del codo? porque se refleja a lo que sería un codo humano y la idea es que el número concreto va a ser aquel donde está justo la parte del codo. Bueno, no se ve mucho, justo la parte del codo. A veces es complicado decidir oye, ¿el codo está en el 2 o el codo está en el 3? Podemos tener diferencias. Entonces, ya sea 2, ya sea 3, lo importante es que luego sepáis vosotros interpretar los clústeres. A veces te va a decir que son dos clústeres y luego cuando vayáis a intentar interpretarlos no vais a encontrar ningún resultado y a veces hay tres clases os pasaría más de lo mismo, entonces si en el examen ponéis dos o ponéis tres, ambas son válidas, ¿vale? pero sí que es importante que debéis ser capaces vosotros de analizar los resultados de los clases con las medias como hemos hecho anteriormente de todas formas es una manera bastante artesanal, ¿vale? porque al final tenéis que estar vosotros si es el dos, si es el tres, entonces existe una tercera porque mucha gente la prefiere, ¿vale? Que es library, en este caso, library, en este caso utilizaremos la librería nbclust, ¿de acuerdo? Y dentro de esta librería nbclust vamos a utilizar la función con el mismo nombre, nbclust, ¿de acuerdo? Como función y vamos a poner datos numéricos, ¿vale? ahora vamos a poner más menos que el mínimo tiene que ser dos clusters y el máximo tiene que ser como mucho quiero que me analice hasta ocho clusters y el método que voy a utilizar es el método de Cummins cuando nosotros ejecutamos esta función tarda un poco porque dice un montón de información vale nos da toda esta información pero de toda esta información lo que tenemos que mirar es lo siguiente. Este cuadrito de aquí, ¿vale? Te dice, bueno, lo que hace es seleccionar varios índices, varias formas de analizar cuál sería el mejor número de clusters, 11 de los cuales dijeron que fueron 2, 11 de los cuales dijeron que era mejor hacer 3 grupos y 2 propusieron 8 grupos como el mejor de los clusters. En conclusión, el ordenador nos dice, oye, teniendo en cuenta la ley de la mayoría, la mejor opción sería dos, ¿vale? Pero fijaros que tanto dos como tres lo han propuesto 11 personas, es decir, no hay realmente una mayoría, simplemente selecciona la mayoría y luego se queda con el primero que haya. O sea que dos o tres, ambos serían útiles, ¿de acuerdo? Hasta aquí, ¿se ha quedado entendido lo que os he explicado de todo el tema del clúster? El clúster básicamente vendría siendo un poco lo que hemos comentado para hacer un resumen de todo lo que hemos visto. Profe. Cluster, claro. Sí, dime. Ahí entonces hallamos el óptimo, supuestamente. Exacto. Y sería el valor que vosotros reemplazáis aquí. Aquí en lugar de tres, sería el dos. Entonces volveréis a hacer... Y reiteramos otra vez. Exacto. Yo os voy a decir cómo lo hago yo normalmente, ¿vale? Lo que hago es, primero, por supuesto, cargas datos, miras la dimensión, miras el STR, miras el summary y miras si hay valores nulos, ¿vale? En el caso de que haya valores nulos, los podéis omitir casi con total seguridad o decidís entre omitirlos o reemplazarlos por otro valor, ¿vale? ese sería el primer etapa primer etapa análisis de los datos ¿vale? en esta primera etapa si tuvierais columnas con valores de tipo texto y los quisieseis utilizar en la clasterización tendríais que pasarlo a valores numéricos que veremos en la siguiente semana que tenemos esas dos clases ¿vale? una vez que se ha hecho esa primera etapa ¿vale? esa primera etapa de análisis del dataset que esta es común, tanto si estás haciendo una regresión lineal como si estás haciendo una regresión logística, como si estás haciendo una clasterización, esta parte es común en todos los casos, ¿vale? Lo siguiente que vamos a hacer es decir vale, perfecto, pues una vez que ya tengo todos los datos preparados, ahora me quedo con las variables que son numéricas o las que si tienes texto las puedes convertir a numéricas y lo que yo haría ya directamente, pero directamente es hacer, a menos que me diga lo contrario hacer el método del codo o el método del codo o este método o el nbclast, el que prefiráis ¿vale? hacemos este método, sabemos cuántos valores, o sea cuántos grupos tengo que hacer por lo que me han recomendado por tanto una vez que sé cuántos grupos tengo que hacer ¿qué haría? haría el camins con ese número de grupos haría la clasterización haría la clasterización barra dólar claster y luego haríamos la tabla ¿vale? efectivamente David, exactamente ¿vale? puedes pasar numéricas con if else a las que son yes y no y las otras con factor creo que alguna vez la hemos visto también para ver la revisión logística si no recuerdo mal pero bueno, lo repasaremos y ese sería el orden ¿qué nos queda ver? nos queda ver una parte que es utilizar entre comillas estos datos que nos han dado y con un árbol de decisión ser capaz de interpretar los clusters que esto lo veremos la próxima semana que tenemos clases esperad un momento y allí una vez se tenga el resultado, por ejemplo, ¿cuál sería cuál sería la interpretación? Por ejemplo corramos los probes, ya sabemos que son dos, ¿cuál sería la interpretación? Perfecto Vale, una cosa, el último método que terminamos es el mínimo y es el máximo que se pone en el código ¿vale? Esto es más o menos yo os lo recomendaría entre 2 y 10 no suele ser mucho más de 2 y 10 puedes poner 2.8, 2.10 no suelen ser, normalmente a menos que tengáis un conjunto de datos muy variopintos, como muchos suelen poner para intentarlo con el 10, y si veis que con el que ninguno os conforma pues podéis aumentar el máximo a más, pero generalmente con 2.10 os servirá, dicho esto ¿Hacemos el cambio? Sí ¿Y lo que recomiendas es que hagamos las 3 pruebas o con una sería suficiente? Con una, vale Con una es suficiente en caso de que, a ver, a mí personalmente si queréis algo mucho más exacto sería esta, ¿vale? Pero cuando trabajes con Python no tienes como, o no existía, tengo que revisarlo, esta función. entonces si queréis algo que sea más parecido a R y Python, más o menos hago lo mismo y simplemente cambio el cómo lo llamo, entonces utilizad el método del code, ¿vale? porque os va a servir también para Python, esta es una cosa muy buena que tiene R pero que no tiene por qué tener Python no lo tenía hasta hace unos par de años que yo estuve buscando, ¿vale? pero a lo mejor lo han añadido recientemente dicho esto aquí, lo que vosotros tenéis que mirar para analizar, ¿vale? es esa parte ¿vale? por ejemplo este era muy sencillito porque decíamos pues casi todos los datos son mayores en el grupo 1 que en el grupo 2 pues en el grupo 1 que son aquellas flores que tienen la longitud del sépalo más grande la longitud del pétalo más grande y la longitud y el ancho del pétalo más grande pues serán flores grandes y en el cluster 2 estamos ante la longitud del pétalo más pequeño el ancho del pétalo más grande la longitud del pétalo más pequeño y el ancho del pétalo más pequeño? Pues flores pequeñas, ¿vale? De todas formas, mira, os lo voy a buscar, porque al final todo esto... Vale, os voy a explicar una cosa, pero no os la voy a profundizar, ¿vale? Que esto es lo que veremos el próximo día. Pero lo que nos quedaría, nos quedaría encontrar una manera menos, entre comillas, aleatoria, ¿no? De poder decir si es o no es un... De poder explicar la interpretación, ¿vale? Nos quedaría como esa manera menos aleatoria. Entonces, os lo voy a poner ahora, ¿vale? Pero pensad que lo vamos a repasar el próximo día, ¿vale? Entonces, en este sentido, para hacerlo, lo que podemos hacer es... Vamos a hacer un árbol de decisión que es para una clasificación. Es decir, lo que vamos a hacer es algo parecido a lo que comentasteis, ¿vale? Hacer una clasificación, pero tomando las categorías, ¿de acuerdo? Que nos ha dado la clasificación. entonces el árbol de decisión ¿cómo se hacía? teníamos que implementar el rpar y el rpar plot bueno, si no he puesto el plot rpar.plot para poder dibujarlo ¿vale? y ahora lo que hacíamos era que el árbol era el rpart de vamos a utilizar la clasterización claster ¿de acuerdo? clasterización claster lo vamos a utilizar a qué son los clusters, los grupos que me ha dado el algoritmo. Y voy a intentar predecirlos en base a la longitud del sépalo más la longitud, bueno, el ancho del sépalo más la longitud del pétalo más la longitud del, no, el ancho del pétalo. ¿Por qué utilizo árbol de decisión? Porque estamos clasificando en tres categorías o en dos categorías y al final os va a resultar más cómodo. Recordemos que regresión logística solo puede ser cuando tenéis dos opciones, por lo tanto cuando tengáis más de dos grupos no podréis utilizarlo, así que por norma general utilizaréis más este caso. aquí podríamos hacer el summary de árbol si queréis pero lo importante era cuando hacíamos el rpart.plot de árbol, entonces si nosotros ejecutamos esto lo repasaremos el próximo día, si vosotros ejecutamos este, le damos zoom que vemos aquí aquí vemos por ejemplo que una de las variables que se ha tenido en cuenta, si el pétalo es menor que 2,5 si el pétalo es menor menor que 2,5 ya directamente lo clasifica todo el grupo 1 entonces sabemos que el grupo 1 son aquellos que el pétalo es menor que 2,5 así después el pétalo es mayor que 2,5 y además el pétalo es mayor que 5,2 fijaros que ya me lo clasifica en el grupo 2 y después tendríamos la longitud del pétalo, la longitud del pétalo que si es mayor o igual que 6,5 lo pondría en 3 y si está de la otra forma estaría como entre 2 y 3 ¿por qué os ha salido este 2.6? porque el árbol de decisión al ser 1, 2 y 3 interpreta que no son textos que no son categorías como tal sino que son números entonces para que esto no nos pase añadimos el method class que le estamos diciendo oye no puedes tener valores intermedios es 1, 2 o 3 no puedes tener un valor intermedio entonces lo volvemos a ejecutar vale, hacemos el summary y lo importante es hacemos el reparto vale, y fijaros ahora simplemente en el verde que me ha salido vale si nos fijamos en el verde que me ha salido si quiere el verde ah, espera que lo tendré por aquí, un momento si, vale si nos vamos al verde que me ha salido fijaros que ahora ya no me sale este 2.6 sino que me sale 1, 2 o 3 y los considera como texto, vale Entonces si es mayor que 2,5 directamente va al 1, si es menor que 2,5 se va al 1, porque aquí tenéis, aunque aquí no lo veis, aquí hay un yes, porque aquí está el no. si es mayor que 2,5 entonces evaluamos, ¿es mayor o igual que 5,2? en el caso de que sí sea mayor o igual que 5,2 va al 2 y en el caso contrario iría al 3 pero esta parte la explicaremos más que es la parte también de interpretación que quizás pueda resultar más útil ¿se entiende? puede ser que sí, puede ser que no igualmente esto lo repasaremos la próxima semana dejadme comprobar cuántas clases más tengo con vosotros. Dime. Por ejemplo, en este caso el programa me está subiendo dos clasificaciones, ¿cierto? Y yo, por ejemplo, en mi información o en mis datos tenía aparentemente tres, ¿no? Sí. entonces allí yo podría o sea como conclusión pero ya interna podría yo reclasificar mi información y hacerle caso al sistema es partiendo de que exacto podrías hacerlo lo que pasa que en un caso tú probablemente hayas hecho una clasificación porque te interesaba conocer una serie de características y por tanto tenías esa clasificación y el ordenador lo ha clasificado como él buenamente ha querido por lo tanto puede que no sea una clasificación que se amolde a lo que tú quieres pero por supuesto podrías cambiarlo estoy viendo que tenemos todavía clases prácticamente hasta el 9 de febrero así que no os preocupéis porque esto lo trataremos con mucho más detalle habíamos quedado en revisar el punto 4 de la tarea creo que os lo he revisado está en comentarios creo que lo he revisado y lo he puesto en conocimiento creo, el punto 4 exactamente estuve revisando unos cuantos en realidad, a ver, sobre todo más que nada, por lo que he visto sí que es cierto que el profesor os ha comentado a la parte de la rúbrica, en la mayoría de vosotros os ha comentado un poco el por qué así que es cierto que he visto que en algunas partes es un poco porque habéis puesto, os preguntaban por correlación y covarianza y solo habéis explicado correlación, entonces entiendo un poco ese punto, ¿vale? Entonces, sí, en principio está revisado y lo están mirando ¿vale? Ah, vale, vale, vale por eso os quería comentar que más o menos estoy de acuerdo dentro bastante con lo que comentó el otro Sí, efectivamente, sí, sí, sí estoy bastante de acuerdo, ¿eh? O sea que, bueno, os lo comentarán y lo estamos mirando esto es lo que quería comentar y estoy bastante de acuerdo con lo que comentaba el profesor corrector y luego desde el punto de vista queda el punto 4 de la entrega vale, dame 5 segundos que miramos esta entrega la entrega, esta es la entrega número 2 si no recuerdo mal vale, que la tenéis que entregar, muy importante antes del 12 de enero vamos a hacer el descarga en material pero profe dijiste que lo podríamos entregar hasta el hasta el 3 sí, sí, sí, exacto hasta que tengamos la clase de corrección ¿vale? entonces, actividad modelos de clasificación de acuerdo al punto 4 que básicamente es cómo se podría obtener una clasificación de la importancia de las variables del modelo esto es lo que nos faltaba ¿no? ¿puede ser? sí, es el tema perfecto pues este si os queréis os lo explico es muy rápido, son dos líneas de código y os lo explico el próximo día en la clase que tenemos si no recuerdo mal la otra clase que hemos puesto de repaso y así lo explico para todos que sería abrir que si no recuerdo mal la tenemos el miércoles 14 de enero y ya os pillamos lo voy a explicar ahora no os preocupéis dadme 5 segunditos que vaya a el documento concreto Vale, ¿puedo explicaroslo bien? Un momentito, ¿eh? Pues siento que os quedéis un ratito más, pero yo creo que también es útil para que lo sepáis. Entonces, si no recuerdo mal, esta es la última clase que tuvimos. Un momentito, ¿eh? si no recuerdo mal esta es la última clase que tuvimos entonces os la voy a poner aquí y os comparto el documento compartir pantalla compartir pantalla, compartir aquí y os lo subiré también en el documento, vale pues modificar el documento ahora para que lo tengáis entonces creo que este es el mismo que vimos que fue sobre Titanic, que estábamos hablando de clasificación. Entonces, con vuestro permiso, lo ejecuto todo. Los veo. Vale, y la pregunta que estabais preguntándome es la parte de cómo se podría obtener una clasificación de la importancia. Vale, cuando hablamos de clasificación de la importancia, es básicamente qué variables se ha tenido como más en tal hora de hacer la regresión logística o de la hora de hacer el árbol de decisión. Para esto es mucho más fácil, ¿de acuerdo? El árbol de decisión, porque lo podemos tener con el... Perdón, que esto ya lo tengo instalado. Entonces, hazme 5 segundos que termine todo esto. Probabilidad, Kate, exponencial, exponencial, exponencial, árboles de decisión. Vale. vale, llegamos hasta aquí ¿puede ser? ¿os acordáis de esto? decidme que sí, por favor en esto lo voy a cerrar vale, perfecto pues ahora lo que tenemos que hacer es intentar encontrar cómo podemos predecir, o sea, lo que se está preguntando es ¿la variable o la columna por ejemplo, la primera columna ¿cuánto importa? pues esto lo tenéis ¿vale? cuando hacéis la regresión logística con el árbol de decisión tenéis otra forma de hacerlo pero lo que en realidad se están preguntando es referido a los coeficientes ¿vale? ¿cuánto afecta o cuánto deja de afectar? en este caso por ejemplo ¿cuál sería la que más afectara? tiene truco ¿vale? ¿por qué tiene truco? porque ¿vale? cuando hacéis una regresión logística como es este caso y hacéis el summary y tenéis los los parámetros de la exponencial, tenemos exponencial menos 0,03698, que sería este caso de la edad. Es decir, para calcular cómo de importante es, lo que se hace es calcular la exponencial de este valor que veáis aquí. ¿De acuerdo? Entonces, por ejemplo, si estamos hablando de... Vale, por ejemplo, en este caso dice, oye, por cada vez que el... por cada año que tiene, por cada año que es positivo que aumentamos en uno la edad ¿cuál es la probabilidad de sobrevivir? pues se reduce en este caso en un 3,6% entonces creo, si no recuerdo mal que os estaban preguntando respecto a esto, de todas formas existe otra función ¿a qué es la siguiente? ¿qué es la siguiente? perdón, sé que estoy aquí con respondiendo un correo vale, entonces ¿cuál sería la siguiente? dentro del Rpart, que hemos hecho aquí el Rpart dentro de Survive, Age Sex y luego el Pclass lo hemos puesto como un As Factor vosotros podríais querer saber cómo serían las importancias, esto lo podríais diferenciar cuando nosotros hacemos modelo árbol ¿vale? dólar y luego ponéis la variable y la importancia ¿vale? entonces por ejemplo si nosotros ponemos el summary del modelo árbol, debería salirnos vale, un momento a ver vale, aquí más o menos nos lo aparecería, pero si no por ejemplo digamos modelo árbol, la variable age y luego aquí hacemos la importancia, que es importance y esto en principio para cada una de las columnas nos debería funcionar debería, siempre funciona luego el día que quiero que funcione aero momento tenemos modelo árbol modelo árbol modelo árbol la columna es la columna es y luego la palabra importance y el modelo árbol lo tenemos como el método class y con un reparto vale porque no me está saliendo esto que siempre funciona vale me sale en un lo porque un momentito si nosotros hacemos el summary de modelo árbol si no lo podéis mirar por el summary seguro pero es que hay tanta información vale, tenemos el nSplit que es por el número de nodos que lo ha dividido tenéis el error vale, tenéis la variable bueno, pues aquí lo tienes variable importancia ¿qué es? la variable sexo en este caso ha sido 64 la variable age tiene 17 y el asfactor básicamente es que digáis esta parte de aquí ¿sí? entonces ¿cuál es la variable que más ha tenido en cuenta? la variable del sexo ¿sí? ¿se entiende? ¿de dónde lo sacamos profe? ¿de qué? del summary, es que hay otra forma de hacerlo, pero no me está saliendo que es básicamente esta, no me ha salido entonces, vosotros cuando hacéis el summary y del modelo de, en el caso de árbol de decisión, ¿de acuerdo? Vosotros dentro de este summary vais hacia arriba, prácticamente arriba del todo. Y aquí, justo debajo de donde ponga esta tablita de datos, tenéis una cosa que se llama variable importancia. Y aquí tenéis el sexo son 64, las factor preclass 19 y el age son 17. De hecho, si no recuerdo mal, están, si lo sumáis da 100, ¿vale? Esos son porcentajes. es decir, el sexo importa un 64%, la edad un 17% y las factor class un 19%. De hecho, sumamos 64 más 17 más 19. O sea, que la variante que más pesa en el modelo es el sexo. Exactamente, sí. Luego iría la categoría de pasajero y después iría la edad, aunque más semejantes. si se entiende, os están preguntando dentro del modelo que le deis esta parte de variable importancia con el modelo del árbol es muy fácil porque es repasarlo, hay una forma pero es que no me ha salido, me ha dado un error tendría que ponerme a mirar, lo puedes hacer diciendo oye dame esta columna y miramos la importancia de todas formas dejarme mirar si así y con el modelo logito solo le detallamos árbol vale, en el caso del modulo logit sí que es cierto que podéis hacer referencia a lo que he comentado de los coeficientes pero sí que es cierto que yo os aconsejaría hacerlo con los dos para que tengáis la nota más perfecta de todos en este caso por ejemplo también los coeficientes y esto en el fondo también te está diciendo igual que una regresión lineal te estaría diciendo cómo hace que varíe el resultado por tanto implícitamente te está dando también el resultado de la importancia pero sí que es cierto que nunca vas a tener un dato tan bueno como el que viene del propio modelo de regresión porque de hecho se utiliza muchísimo para calcular las importancias Sí, mejor si lo haces por esta parte y en el caso de que lo hagáis con la regresión aparte de las estrellitas que se indican si es significante o no deberíais analizar también los coeficientes Si los coeficientes son mayores, pues probablemente el impacto sea mayor. Y si los coeficientes sean menores, probablemente el impacto sea menor. Pero sí que excepto que habiendo os dado el árbol de R-PAR, yo creo que van buscando más que aparte de hacerlo con una regresión, lo hagáis con un árbol de decisión y que saquéis este valor. ¿Cómo es la interpretación con los estimados, con el parámetro? Vale, te refieres a la logística, ¿no? Sí, acá en la logística donde estás mencionando que con el estimado se puede decir cuál tiene más significancia. Sí, esto son como los coeficientes, no, ojo, no más significancia, sino más... Hay dos cosas, una cosa es la significancia, que aunque el valor sea grande puede que no sea significante, y otra cosa, o sea, yo sé que de normal pensamos que más o menos lo mismo, pero son dos cosas diferentes, ¿vale? Y otra cosa es la importancia. Entonces, tienes que analizar tanto la significancia como analizar el tamaño que es el coeficiente. Y el coeficiente normalmente cuando hablamos de regresión logística se suele analizar en porcentaje, se suele analizar con el exp y el valor en este caso del coeficiente. De todas formas, si os han dicho tan tan claro y la entrega está puesta tan tan claro analizar la importancia yo no me complicaría y me iría que me la analizasen un summary del modelo de árbol que aparte es práctica es hacer lo mismo que la regresión logística literalmente lo mismo solo que en lugar de GLM utiliza SRPAR hacéis el summary del modelo de árbol y no os compliquéis o sea, estáis aquí y decís mira, la importancia de las variables según el árbol de decisión son 64 el sexo el P class 19 y el A 17 ¿me explico? porque al final es copiar y pegar la misma frase que tengáis en la regresión logística la copiáis y pegáis y cambiáis a R part y aparte en el momento en que hagáis la regresión logística sí que tendréis que explicar los coeficientes y tal pero así os aseguraréis no cuesta nada porque es una línea más y os aseguraréis de haberlo hecho perfecto entonces espero que sí Vale, entonces el tema es ese, ¿vale? O sea, ya que es hacer más o menos lo mismo, pues nos debería costar mucho, ¿vale? que tenía tres categorías usaba el plugins sí, existen muchísimas librerías como os digo aquí y como os comenté en la clase que hemos tenido esta tarde el hecho de que yo es de una forma no quiere decir que haya 200 formas más de hecho lo habéis visto por ejemplo con como yo trato los nulos, lo habéis visto por ejemplo en los select, utilizo mucho la librería de plir, hay gente que no utiliza para nada la librería de plir entonces intentamos mantener un nivel todavía medianamente bajo y no ver muchas librerías porque ya suficiente tenéis de ver todo esto de nuevas ¿vale? pero si alguien lo conoce de otras formas, otros métodos otras cuestiones, por supuesto, bienvenido sea ¿vale? o sea, no hay necesidad por ejemplo en mi caso sí es que no pude estar en la clase que diste de ropas esa la vas a cargar en la documentación y cuándo la encargas si sería bueno este entonces no para los que no habéis estado la clase de repaso ha sido de los cuatro grupos conjuntos, tenemos una más el miércoles de la semana que viene, así que haciéndoos caso a uno de vosotros que me lo puso por el chat, en ese momento no podía porque estaba con muchísimas más asignaturas y no me daba tiempo a la vida pero os he conseguido redactar como una especie de libro con todas las funciones que al menos yo son las que más utilizo, ¿vale? Esto no quiere decir que sean las que utilicéis o no utilicéis. Sí, también es válida, Juan. Sí, es perfectamente válida, ¿vale? Entonces, por cierto, Juan nos ha dado también otra forma que también está bastante bien, ¿vale? De modelo árbol, dos puntos, variable importancia y decrease en igual a otro. Esa también es una muy buena forma de tener las importancias, ¿vale? Dicho esto, la clase está grabada, pero como no es como toda una clase de este grupo, no sé dónde la tendréis, tengo que preguntar a ver dónde está y creo que alguien dijo que estaba en el aula general, la grabación, bueno, me aseguraré, y este documento os lo intentaré pasar entre hoy y mañana a más tardar para que lo tengáis, estará dentro de documentación esto sí que ya estará dentro de vuestros grupos pues sí, estará en aula general y bueno, hemos repasado todo lo que sería muy importante tema de filtros tema de columnas, tema de group by, temas de medias que hemos repasado hoy, tema de nulos, muy muy importante ¿de acuerdo? y luego ya sí, sí, sí perfecto, pues muchísimas gracias, de acuerdo, espero que la clase os haya gustado, bueno, feliz año felices fiestas, ya venía de una clase anterior y no os lo he dicho espero que hayáis tenido una buena entrada de año, hayan sido unas fiestas muy provechosas, sobre todo para descansar y coger pilas, estáis ya a punto de terminar este primer cuatrimestre así que por mi parte, como siempre, un placer y nos vemos la próxima semana, ¿vale? cualquier duda me podéis comentar por el foro vale, veo que tengo un chat gracias muchísimas gracias, adiós
